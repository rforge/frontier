
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## Code to estimate Fan, Li and Weersink (1996)
> ## Semiparametric Stochastic Frontier Model
> 
> library( "npFrontier" )
Loading required package: np
Nonparametric Kernel Methods for Mixed Datatypes (version 0.60-2)
[vignette("np_faq",package="np") provides answers to frequently asked questions]
Loading required package: bbmle
Loading required package: stats4
> 
> ## Generate some fake data to try code out on
> ## Use Model 3 of FLW (1996)
> lambda   <- 1.88
> sigma.sq <- 1.66
> mu       <- 0
> 
> sig.v <- sqrt(sigma.sq/(1+lambda^2))
> sig.u <- sig.v*lambda
> 
> ## Run small scall simulation to mimic FLW, Table 3.
> set.seed( 123 )
> 
> n <- 200
> 
> v <- sig.v*rnorm(n)
> u <- sig.u*abs(rnorm(n))
> #u <- sig.u*rexp(n)
> 
> e <- v-u
> 
> x <- rchisq(n,1)
> 
> y <- 1+log(1+x)+e
> 
> # function for printing objects returned by sfaFLW():
> printFLW <- function( x ) {
+   for( i in 1:length( x ) ) {
+     cat( "$", names( x )[ i ], "\n", sep = "" )
+     if( names( x )[ i ] == "npreg" ) {
+       x[[ i ]]$bw <- round( x[[ i ]]$bw, 2 )
+       print( x[[ i ]] )
+     } else {
+       print( round( x[[ i ]], 2 ) )
+     }
+     cat( "\n" )
+   }
+   
+   cat( "> residuals( x, which = \"first\" )\n" )
+   print( round( residuals( x, which = "first" ), 2 ) )
+   cat( "\n> residuals( x )\n" )
+   print( round( residuals( x ), 2 ) )
+   
+   cat( "\n> fitted( x, which = \"first\" )\n" )
+   print( round( fitted( x, which = "first" ), 2 ) )
+   cat( "\n> fitted( x )\n" )
+   print( round( fitted( x ), 2 ) )
+   
+   cat( "\ngradients( x )\n" )
+   print( round( gradients( x ), 2 ) )
+   
+   invisible( x )
+ }
> 
> 
> # local-constant regression, rule-of-thumb bandwidths
> sfa.flw <- sfaFLW( y ~ x, bwmethod = "rot" )  # ,dis="ntn"
> 
> printFLW( sfa.flw )
$npreg

Regression Data: 200 training points, in 1 variable(s)
                 x
Bandwidth(s): 0.43

Kernel Regression Estimator: Local-Constant
Bandwidth Type: Fixed

Continuous Kernel Type: Second-Order Gaussian
No. Continuous Explanatory Vars.: 1


$mu
[1] 0.91

$mprime
        [,1]
  [1,]  0.56
  [2,]  0.22
  [3,]  0.28
  [4,]  0.86
  [5,]  0.80
  [6,]  0.30
  [7,]  0.23
  [8,]  0.22
  [9,]  0.32
 [10,]  0.21
 [11,]  0.60
 [12,]  0.29
 [13,]  0.87
 [14,]  0.22
 [15,]  0.22
 [16,]  0.22
 [17,]  0.08
 [18,]  0.47
 [19,]  0.88
 [20,]  0.23
 [21,]  0.23
 [22,] -0.05
 [23,]  0.21
 [24,]  0.38
 [25,]  0.22
 [26,]  0.28
 [27,]  0.21
 [28,]  0.21
 [29,] -0.13
 [30,]  0.21
 [31,]  0.03
 [32,]  0.32
 [33,]  0.40
 [34,]  0.00
 [35,]  0.38
 [36,]  0.22
 [37,]  0.34
 [38,]  0.05
 [39,]  0.06
 [40,]  0.23
 [41,]  0.35
 [42,]  0.21
 [43,]  0.23
 [44,]  0.22
 [45,]  0.57
 [46,]  0.21
 [47,]  0.28
 [48,]  0.46
 [49,]  0.23
 [50,]  0.48
 [51,]  0.26
 [52,]  0.41
 [53,]  0.22
 [54,]  0.83
 [55,] -0.12
 [56,]  0.30
 [57,]  0.50
 [58,]  0.64
 [59,]  0.88
 [60,]  0.42
 [61,]  0.33
 [62,]  0.53
 [63,]  0.75
 [64,]  0.22
 [65,]  0.73
 [66,]  0.76
 [67,]  0.69
 [68,]  0.21
 [69,]  0.21
 [70,]  0.29
 [71,]  0.27
 [72,]  0.24
 [73,]  0.38
 [74,]  0.22
 [75,]  0.22
 [76,]  0.29
 [77,]  0.41
 [78,]  0.33
 [79,]  0.22
 [80,]  0.02
 [81,]  0.22
 [82,]  0.30
 [83,]  0.25
 [84,]  0.21
 [85,]  0.58
 [86,]  0.31
 [87,]  0.78
 [88,]  0.24
 [89,]  0.32
 [90,]  0.21
 [91,]  0.46
 [92,]  0.28
 [93,]  0.43
 [94,]  0.07
 [95,]  0.87
 [96,]  0.23
 [97,]  0.39
 [98,]  0.25
 [99,]  0.25
[100,]  0.21
[101,]  0.30
[102,]  0.03
[103,]  0.43
[104,]  0.90
[105,]  0.42
[106,]  0.87
[107,]  0.25
[108,]  0.03
[109,]  0.22
[110,]  0.83
[111,]  0.21
[112,]  0.26
[113,] -0.08
[114,]  0.72
[115,]  0.64
[116,] -0.03
[117,]  0.05
[118,]  0.11
[119,]  0.67
[120,]  0.21
[121,]  0.21
[122,]  0.33
[123,]  0.27
[124,]  0.22
[125,]  0.39
[126,]  0.21
[127,]  0.87
[128,]  0.78
[129,]  0.24
[130,]  0.78
[131,]  0.23
[132,]  0.27
[133,]  0.21
[134,]  0.77
[135,]  0.21
[136,]  0.13
[137,]  0.32
[138,]  0.25
[139,]  0.77
[140,]  0.25
[141,]  0.21
[142,]  0.75
[143,]  0.22
[144,]  0.22
[145,]  0.38
[146,]  0.26
[147,]  0.22
[148,]  0.28
[149,]  0.21
[150,]  0.34
[151,]  0.40
[152,]  0.65
[153,]  0.49
[154,]  0.31
[155,]  0.21
[156,]  0.22
[157,]  0.22
[158,]  0.27
[159,]  0.49
[160,]  0.81
[161,]  0.24
[162,]  0.24
[163,] -0.08
[164,]  0.07
[165,]  0.86
[166,]  0.21
[167,]  0.08
[168,]  0.49
[169,]  0.54
[170,]  0.87
[171,]  0.26
[172,]  0.27
[173,]  0.24
[174,]  0.82
[175,]  0.29
[176,] -0.11
[177,]  0.31
[178,]  0.06
[179,]  0.40
[180,] -0.04
[181,]  0.66
[182,]  0.86
[183,]  0.62
[184,]  0.45
[185,]  0.29
[186,]  0.22
[187,]  0.08
[188,]  0.22
[189,]  0.24
[190,] -0.01
[191,]  0.54
[192,]  0.21
[193,]  0.42
[194,]  0.22
[195,]  0.81
[196,]  0.21
[197,]  0.32
[198,]  0.00
[199,]  0.88
[200,]  0.53

$sigma.sq
[1] 1.62

$lambda
[1] 2.07

$sigma.u
[1] 1.14

$sigma.v
[1] 0.55

$bw
   x 
0.43 

> residuals( x, which = "first" )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-1.76 -0.78  1.59  0.35  0.49  1.59  0.24 -0.59 -1.30  0.50  1.44  0.77 -0.21 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
 0.32 -0.61  0.03  0.22 -0.94 -0.02 -0.87 -0.44  0.20 -1.06 -0.16  0.05 -0.14 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
 0.53  0.10 -0.71  0.43 -0.91  0.71  1.34  0.56  0.88 -0.22  1.22 -0.05  0.08 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-0.24 -0.30  0.13 -1.60  0.87  1.61 -2.02  0.60 -0.76  0.59  0.47  0.65  0.40 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
 0.43  1.76 -0.96  1.80 -1.09  0.72  0.91 -0.56  0.63  0.22  0.81 -1.24 -2.19 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-0.51  0.97 -1.13  0.94  2.10 -0.32 -1.61  0.87 -1.16 -0.29  1.07  0.68  0.18 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
 0.47  0.75 -1.04  0.37  0.25  0.92  0.82  1.03  1.47 -0.71  0.55  1.33  0.10 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
 0.08 -0.10 -0.59 -0.47  0.42  0.24  0.30  0.74 -1.21 -0.27 -0.09 -0.16 -0.47 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.02  0.57 -1.86 -0.19 -0.78 -0.73 -1.00  0.60 -1.92  0.36  1.00  0.26  0.80 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-1.41 -1.35 -0.83  0.62 -0.96 -0.88 -0.06  0.94 -0.34  1.07  0.38 -1.21  1.00 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
 0.58 -0.14  0.03 -1.11 -0.85 -0.57 -1.44  1.12  1.23 -0.08  0.54 -0.18 -1.99 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.14  0.01 -1.38 -0.15  0.71  0.99  0.03  0.37 -0.72  0.79  0.24 -0.27  0.31 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
 0.71  0.67 -1.14 -2.11  1.29 -0.48 -0.18  1.24 -0.17  0.78  1.03 -0.29  0.42 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
 0.64 -1.95 -0.90  0.34  1.38 -0.20 -0.33 -0.13  0.88  1.29 -1.28  0.40  1.56 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
 0.68 -0.90  0.27 -0.84  1.00 -0.39  0.86  0.35  0.48 -1.82  0.11 -0.64 -0.40 
  196   197   198   199   200 
 0.32  0.48  0.00 -0.84 -0.04 

> residuals( x )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-2.67 -1.69  0.68 -0.56 -0.42  0.68 -0.67 -1.50 -2.21 -0.41  0.53 -0.14 -1.13 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
-0.59 -1.53 -0.88 -0.69 -1.86 -0.93 -1.79 -1.35 -0.71 -1.97 -1.08 -0.86 -1.05 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
-0.38 -0.81 -1.62 -0.49 -1.82 -0.20  0.43 -0.36 -0.04 -1.13  0.30 -0.96 -0.83 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-1.16 -1.21 -0.78 -2.52 -0.04  0.70 -2.93 -0.31 -1.67 -0.33 -0.44 -0.27 -0.52 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
-0.48  0.84 -1.88  0.88 -2.00 -0.19  0.00 -1.47 -0.28 -0.69 -0.10 -2.15 -3.10 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-1.43  0.06 -2.04  0.03  1.19 -1.23 -2.52 -0.05 -2.07 -1.21  0.16 -0.23 -0.74 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
-0.44 -0.16 -1.96 -0.54 -0.66  0.01 -0.09  0.12  0.55 -1.62 -0.37  0.42 -0.81 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
-0.83 -1.01 -1.50 -1.38 -0.49 -0.67 -0.61 -0.17 -2.12 -1.18 -1.00 -1.07 -1.38 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.93 -0.34 -2.77 -1.11 -1.69 -1.64 -1.92 -0.31 -2.84 -0.56  0.09 -0.66 -0.11 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-2.32 -2.26 -1.74 -0.29 -1.87 -1.79 -0.97  0.02 -1.25  0.15 -0.53 -2.12  0.09 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
-0.33 -1.05 -0.88 -2.02 -1.76 -1.48 -2.36  0.21  0.32 -1.00 -0.37 -1.10 -2.90 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-1.05 -0.91 -2.30 -1.06 -0.20  0.07 -0.88 -0.54 -1.63 -0.12 -0.67 -1.18 -0.60 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
-0.20 -0.24 -2.05 -3.02  0.38 -1.40 -1.10  0.32 -1.09 -0.14  0.11 -1.21 -0.49 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
-0.28 -2.86 -1.81 -0.57  0.47 -1.11 -1.24 -1.04 -0.04  0.38 -2.19 -0.51  0.64 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
-0.24 -1.81 -0.64 -1.75  0.09 -1.30 -0.06 -0.56 -0.44 -2.73 -0.81 -1.55 -1.32 
  196   197   198   199   200 
-0.59 -0.44 -0.91 -1.75 -0.95 

> fitted( x, which = "first" )
  [1] 0.40 0.19 0.22 0.88 0.97 1.19 0.19 0.19 0.25 0.18 1.08 1.15 0.85 0.18 0.19
 [16] 0.19 2.23 0.34 0.82 0.19 0.19 1.14 0.18 1.23 0.18 0.22 0.18 0.18 1.15 0.18
 [31] 1.14 0.25 0.30 1.18 0.28 0.19 1.20 2.26 2.27 0.19 0.27 0.18 0.19 0.19 0.41
 [46] 0.18 0.23 0.33 0.19 0.35 0.21 0.31 0.19 0.66 1.15 0.24 0.36 0.46 0.80 0.31
 [61] 0.25 0.38 0.56 0.19 0.54 0.57 1.04 0.18 0.18 0.23 0.22 0.20 0.29 0.19 1.16
 [76] 0.23 0.31 0.25 0.19 1.18 0.19 0.24 0.21 0.18 0.41 0.24 0.59 0.20 0.25 0.18
 [91] 1.12 0.22 0.32 2.25 0.76 0.19 0.29 0.21 0.21 0.18 0.24 2.25 0.32 1.51 0.31
[106] 0.78 0.21 1.14 0.19 0.66 0.18 1.17 1.14 0.53 0.46 1.18 1.18 2.22 0.49 0.18
[121] 0.18 0.26 0.22 0.19 2.17 0.18 0.75 0.60 0.20 0.59 0.19 0.22 0.18 0.99 0.18
[136] 1.14 0.25 0.20 0.58 0.20 0.18 0.56 0.19 0.18 0.28 0.22 0.19 0.22 0.18 0.26
[151] 0.30 0.47 0.35 0.24 0.18 0.19 0.18 0.22 0.35 0.63 0.20 0.20 1.17 2.24 0.71
[166] 0.18 1.14 0.35 0.38 0.87 0.21 0.22 0.20 0.64 1.15 1.14 0.24 1.18 0.30 1.14
[181] 0.48 0.71 0.44 1.12 0.23 0.19 1.17 0.19 0.20 1.14 0.39 0.18 0.31 0.19 0.62
[196] 0.18 0.25 1.45 0.81 0.38

> fitted( x )
  [1] 1.31 1.10 1.14 1.79 1.88 2.10 1.10 1.10 1.16 1.09 1.99 2.07 1.76 1.10 1.10
 [16] 1.10 3.14 1.25 1.73 1.11 1.10 2.05 1.09 2.15 1.10 1.14 1.09 1.09 2.06 1.09
 [31] 2.05 1.16 1.21 2.09 1.20 1.10 2.11 3.17 3.18 1.11 1.18 1.09 1.10 1.10 1.32
 [46] 1.09 1.14 1.25 1.11 1.26 1.12 1.22 1.10 1.57 2.06 1.15 1.27 1.37 1.71 1.22
 [61] 1.17 1.29 1.47 1.10 1.45 1.48 1.96 1.09 1.09 1.14 1.13 1.11 1.20 1.10 2.07
 [76] 1.14 1.22 1.17 1.10 2.09 1.10 1.15 1.12 1.09 1.32 1.15 1.50 1.11 1.16 1.09
 [91] 2.03 1.14 1.23 3.16 1.67 1.10 1.20 1.12 1.12 1.09 1.15 3.17 1.23 2.42 1.22
[106] 1.69 1.12 2.05 1.10 1.57 1.09 2.08 2.05 1.44 1.37 2.09 2.09 3.14 1.40 1.09
[121] 1.09 1.17 1.13 1.10 3.08 1.09 1.66 1.51 1.11 1.50 1.10 1.13 1.09 1.91 1.09
[136] 2.06 1.16 1.12 1.49 1.12 1.09 1.47 1.10 1.10 1.20 1.13 1.10 1.13 1.09 1.18
[151] 1.21 1.38 1.27 1.16 1.09 1.10 1.10 1.13 1.27 1.55 1.11 1.11 2.09 3.16 1.62
[166] 1.09 2.05 1.26 1.30 1.78 1.13 1.13 1.11 1.56 2.07 2.06 1.16 2.09 1.21 2.05
[181] 1.39 1.62 1.36 2.04 1.14 1.10 2.09 1.10 1.11 2.05 1.30 1.09 1.22 1.10 1.54
[196] 1.09 1.16 2.36 1.73 1.29

gradients( x )
        [,1]
  [1,]  0.56
  [2,]  0.22
  [3,]  0.28
  [4,]  0.86
  [5,]  0.80
  [6,]  0.30
  [7,]  0.23
  [8,]  0.22
  [9,]  0.32
 [10,]  0.21
 [11,]  0.60
 [12,]  0.29
 [13,]  0.87
 [14,]  0.22
 [15,]  0.22
 [16,]  0.22
 [17,]  0.08
 [18,]  0.47
 [19,]  0.88
 [20,]  0.23
 [21,]  0.23
 [22,] -0.05
 [23,]  0.21
 [24,]  0.38
 [25,]  0.22
 [26,]  0.28
 [27,]  0.21
 [28,]  0.21
 [29,] -0.13
 [30,]  0.21
 [31,]  0.03
 [32,]  0.32
 [33,]  0.40
 [34,]  0.00
 [35,]  0.38
 [36,]  0.22
 [37,]  0.34
 [38,]  0.05
 [39,]  0.06
 [40,]  0.23
 [41,]  0.35
 [42,]  0.21
 [43,]  0.23
 [44,]  0.22
 [45,]  0.57
 [46,]  0.21
 [47,]  0.28
 [48,]  0.46
 [49,]  0.23
 [50,]  0.48
 [51,]  0.26
 [52,]  0.41
 [53,]  0.22
 [54,]  0.83
 [55,] -0.12
 [56,]  0.30
 [57,]  0.50
 [58,]  0.64
 [59,]  0.88
 [60,]  0.42
 [61,]  0.33
 [62,]  0.53
 [63,]  0.75
 [64,]  0.22
 [65,]  0.73
 [66,]  0.76
 [67,]  0.69
 [68,]  0.21
 [69,]  0.21
 [70,]  0.29
 [71,]  0.27
 [72,]  0.24
 [73,]  0.38
 [74,]  0.22
 [75,]  0.22
 [76,]  0.29
 [77,]  0.41
 [78,]  0.33
 [79,]  0.22
 [80,]  0.02
 [81,]  0.22
 [82,]  0.30
 [83,]  0.25
 [84,]  0.21
 [85,]  0.58
 [86,]  0.31
 [87,]  0.78
 [88,]  0.24
 [89,]  0.32
 [90,]  0.21
 [91,]  0.46
 [92,]  0.28
 [93,]  0.43
 [94,]  0.07
 [95,]  0.87
 [96,]  0.23
 [97,]  0.39
 [98,]  0.25
 [99,]  0.25
[100,]  0.21
[101,]  0.30
[102,]  0.03
[103,]  0.43
[104,]  0.90
[105,]  0.42
[106,]  0.87
[107,]  0.25
[108,]  0.03
[109,]  0.22
[110,]  0.83
[111,]  0.21
[112,]  0.26
[113,] -0.08
[114,]  0.72
[115,]  0.64
[116,] -0.03
[117,]  0.05
[118,]  0.11
[119,]  0.67
[120,]  0.21
[121,]  0.21
[122,]  0.33
[123,]  0.27
[124,]  0.22
[125,]  0.39
[126,]  0.21
[127,]  0.87
[128,]  0.78
[129,]  0.24
[130,]  0.78
[131,]  0.23
[132,]  0.27
[133,]  0.21
[134,]  0.77
[135,]  0.21
[136,]  0.13
[137,]  0.32
[138,]  0.25
[139,]  0.77
[140,]  0.25
[141,]  0.21
[142,]  0.75
[143,]  0.22
[144,]  0.22
[145,]  0.38
[146,]  0.26
[147,]  0.22
[148,]  0.28
[149,]  0.21
[150,]  0.34
[151,]  0.40
[152,]  0.65
[153,]  0.49
[154,]  0.31
[155,]  0.21
[156,]  0.22
[157,]  0.22
[158,]  0.27
[159,]  0.49
[160,]  0.81
[161,]  0.24
[162,]  0.24
[163,] -0.08
[164,]  0.07
[165,]  0.86
[166,]  0.21
[167,]  0.08
[168,]  0.49
[169,]  0.54
[170,]  0.87
[171,]  0.26
[172,]  0.27
[173,]  0.24
[174,]  0.82
[175,]  0.29
[176,] -0.11
[177,]  0.31
[178,]  0.06
[179,]  0.40
[180,] -0.04
[181,]  0.66
[182,]  0.86
[183,]  0.62
[184,]  0.45
[185,]  0.29
[186,]  0.22
[187,]  0.08
[188,]  0.22
[189,]  0.24
[190,] -0.01
[191,]  0.54
[192,]  0.21
[193,]  0.42
[194,]  0.22
[195,]  0.81
[196,]  0.21
[197,]  0.32
[198,]  0.00
[199,]  0.88
[200,]  0.53
> 
> all.equal( residuals( sfa.flw, which = "final" ),
+   residuals( sfa.flw ) )
[1] TRUE
> 
> all.equal( fitted( sfa.flw, which = "frontier" ), fitted( sfa.flw ) )
[1] TRUE
> 
> # local-linear regression, rule-of-thumb bandwidths
> sfa.flw.ll <- sfaFLW( y ~ x, bwmethod = "rot",
+   npArg = list( regtype = "ll" ) )
> 
> printFLW( sfa.flw.ll )
$npreg

Regression Data: 200 training points, in 1 variable(s)
                 x
Bandwidth(s): 0.43

Kernel Regression Estimator: Local-Linear
Bandwidth Type: Fixed

Continuous Kernel Type: Second-Order Gaussian
No. Continuous Explanatory Vars.: 1


$mu
[1] 0.94

$mprime
        [,1]
  [1,]  0.83
  [2,]  0.98
  [3,]  0.92
  [4,]  0.74
  [5,]  0.65
  [6,]  0.57
  [7,]  0.97
  [8,]  0.98
  [9,]  0.89
 [10,]  0.99
 [11,]  0.47
 [12,]  0.23
 [13,]  0.76
 [14,]  0.98
 [15,]  0.98
 [16,]  0.97
 [17,]  0.22
 [18,]  0.84
 [19,]  0.78
 [20,]  0.96
 [21,]  0.97
 [22,] -0.07
 [23,]  0.99
 [24,]  0.70
 [25,]  0.98
 [26,]  0.92
 [27,]  0.99
 [28,]  0.99
 [29,] -0.15
 [30,]  0.99
 [31,]  0.05
 [32,]  0.89
 [33,]  0.86
 [34,]  0.00
 [35,]  0.87
 [36,]  0.97
 [37,]  0.64
 [38,]  0.11
 [39,]  0.22
 [40,]  0.96
 [41,]  0.88
 [42,]  0.99
 [43,]  0.97
 [44,]  0.98
 [45,]  0.83
 [46,]  0.99
 [47,]  0.91
 [48,]  0.84
 [49,]  0.97
 [50,]  0.84
 [51,]  0.94
 [52,]  0.85
 [53,]  0.98
 [54,]  0.82
 [55,] -0.15
 [56,]  0.90
 [57,]  0.84
 [58,]  0.83
 [59,]  0.79
 [60,]  0.85
 [61,]  0.89
 [62,]  0.83
 [63,]  0.83
 [64,]  0.97
 [65,]  0.83
 [66,]  0.83
 [67,]  0.54
 [68,]  0.99
 [69,]  0.99
 [70,]  0.91
 [71,]  0.93
 [72,]  0.96
 [73,]  0.86
 [74,]  0.97
 [75,]  0.39
 [76,]  0.91
 [77,]  0.85
 [78,]  0.89
 [79,]  0.98
 [80,]  0.02
 [81,]  0.98
 [82,]  0.90
 [83,]  0.94
 [84,]  0.99
 [85,]  0.83
 [86,]  0.90
 [87,]  0.83
 [88,]  0.95
 [89,]  0.89
 [90,]  0.99
 [91,]  0.36
 [92,]  0.92
 [93,]  0.85
 [94,]  0.19
 [95,]  0.80
 [96,]  0.97
 [97,]  0.86
 [98,]  0.94
 [99,]  0.94
[100,]  0.99
[101,]  0.90
[102,]  0.04
[103,]  0.85
[104,]  0.50
[105,]  0.85
[106,]  0.79
[107,]  0.94
[108,]  0.04
[109,]  0.97
[110,]  0.82
[111,]  0.99
[112,]  0.49
[113,] -0.10
[114,]  0.83
[115,]  0.83
[116,] -0.03
[117,]  0.04
[118,]  0.25
[119,]  0.83
[120,]  0.99
[121,]  0.99
[122,]  0.89
[123,]  0.92
[124,]  0.98
[125,]  0.46
[126,]  0.99
[127,]  0.80
[128,]  0.83
[129,]  0.95
[130,]  0.83
[131,]  0.97
[132,]  0.92
[133,]  0.99
[134,]  0.62
[135,]  0.99
[136,]  0.22
[137,]  0.89
[138,]  0.95
[139,]  0.83
[140,]  0.95
[141,]  0.99
[142,]  0.83
[143,]  0.97
[144,]  0.98
[145,]  0.86
[146,]  0.93
[147,]  0.98
[148,]  0.92
[149,]  0.99
[150,]  0.88
[151,]  0.86
[152,]  0.83
[153,]  0.84
[154,]  0.90
[155,]  0.99
[156,]  0.97
[157,]  0.98
[158,]  0.93
[159,]  0.84
[160,]  0.82
[161,]  0.96
[162,]  0.95
[163,] -0.07
[164,]  0.20
[165,]  0.81
[166,]  0.99
[167,]  0.13
[168,]  0.84
[169,]  0.83
[170,]  0.75
[171,]  0.93
[172,]  0.93
[173,]  0.95
[174,]  0.82
[175,]  0.23
[176,] -0.13
[177,]  0.90
[178,]  0.05
[179,]  0.86
[180,] -0.06
[181,]  0.83
[182,]  0.81
[183,]  0.83
[184,]  0.35
[185,]  0.91
[186,]  0.98
[187,]  0.06
[188,]  0.98
[189,]  0.95
[190,] -0.02
[191,]  0.83
[192,]  0.99
[193,]  0.85
[194,]  0.98
[195,]  0.82
[196,]  0.99
[197,]  0.89
[198,] -0.44
[199,]  0.78
[200,]  0.83

$sigma.sq
[1] 1.64

$lambda
[1] 2.3

$sigma.u
[1] 1.17

$sigma.v
[1] 0.51

$bw
   x 
0.43 

> residuals( x, which = "first" )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-1.92 -0.65  1.62  0.18  0.36  1.43  0.37 -0.46 -1.33  0.66  1.36  0.74 -0.40 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
 0.47 -0.48  0.16  0.23 -1.07 -0.21 -0.76 -0.31  0.21 -0.89 -0.40  0.19 -0.11 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
 0.69  0.27 -0.70  0.59 -0.91  0.68  1.25  0.56  0.80 -0.10  1.03 -0.07  0.05 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-0.14 -0.36  0.29 -1.48  1.00  1.44 -1.86  0.61 -0.89  0.70  0.33  0.70  0.29 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
 0.57  1.54 -0.95  1.79 -1.24  0.53  0.72 -0.67  0.60  0.06  0.60 -1.11 -2.39 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-0.72  0.87 -0.98  1.10  2.11 -0.28 -1.51  0.78 -1.03 -0.38  1.08  0.58  0.14 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
 0.61  0.75 -0.91  0.37  0.32  1.08  0.64  1.02  1.26 -0.62  0.52  1.49  0.05 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
 0.11 -0.21 -0.61 -0.67  0.55  0.15  0.37  0.81 -1.06 -0.27 -0.09 -0.27 -0.64 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.13  0.38 -1.79 -0.20 -0.65 -0.94 -0.84  0.48 -1.91  0.15  0.81  0.26  0.80 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-1.38 -1.55 -0.67  0.79 -1.00 -0.84  0.08  1.03 -0.18  0.86  0.17 -1.12  0.79 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
 0.70 -0.10  0.19 -1.24 -0.68 -0.61 -1.47  1.20  1.02 -0.01  0.70 -0.39 -1.87 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
 0.01 -0.07 -1.34 -0.01  0.74  1.15 -0.02  0.27 -0.91  0.65  0.23 -0.10  0.44 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
 0.86  0.71 -1.28 -2.32  1.39 -0.39 -0.18  1.22 -0.38  0.93  1.00 -0.43  0.26 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
 0.46 -1.90 -0.86  0.43  1.17 -0.23 -0.32 -0.14  0.87  1.20 -1.27  0.21  1.35 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
 0.49 -0.95  0.29 -0.70  1.00 -0.25  0.94  0.35  0.31 -1.66  0.00 -0.50 -0.61 
  196   197   198   199   200 
 0.49  0.45  0.00 -1.03 -0.20 

> residuals( x )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-2.86 -1.58  0.68 -0.75 -0.58  0.50 -0.57 -1.39 -2.26 -0.28  0.43 -0.20 -1.33 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
-0.47 -1.42 -0.78 -0.71 -2.01 -1.15 -1.70 -1.25 -0.73 -1.83 -1.33 -0.74 -1.05 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
-0.24 -0.67 -1.63 -0.34 -1.85 -0.25  0.31 -0.38 -0.14 -1.03  0.10 -1.01 -0.88 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-1.07 -1.29 -0.64 -2.42  0.07  0.50 -2.79 -0.32 -1.83 -0.24 -0.60 -0.23 -0.64 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
-0.37  0.61 -1.89  0.85 -2.17 -0.40 -0.22 -1.60 -0.33 -0.87 -0.33 -2.05 -3.33 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-1.66 -0.06 -1.91  0.17  1.17 -1.22 -2.45 -0.15 -1.97 -1.32  0.15 -0.36 -0.79 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
-0.33 -0.19 -1.84 -0.57 -0.62  0.14 -0.29  0.08  0.32 -1.56 -0.42  0.56 -0.89 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
-0.83 -1.15 -1.55 -1.60 -0.39 -0.78 -0.57 -0.12 -1.99 -1.21 -1.03 -1.21 -1.58 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-1.06 -0.56 -2.72 -1.13 -1.59 -1.88 -1.78 -0.46 -2.85 -0.79 -0.13 -0.68 -0.14 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-2.32 -2.48 -1.60 -0.15 -1.93 -1.78 -0.86  0.09 -1.12 -0.07 -0.77 -2.06 -0.14 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
-0.23 -1.04 -0.74 -2.17 -1.62 -1.55 -2.40  0.26  0.08 -0.95 -0.23 -1.33 -2.80 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.93 -1.01 -2.27 -0.95 -0.20  0.22 -0.96 -0.66 -1.85 -0.29 -0.71 -1.04 -0.50 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
-0.08 -0.22 -2.22 -3.26  0.45 -1.33 -1.11  0.29 -1.32 -0.01  0.07 -1.37 -0.68 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
-0.48 -2.84 -1.80 -0.50  0.24 -1.16 -1.25 -1.08 -0.06  0.26 -2.21 -0.73  0.41 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
-0.45 -1.88 -0.65 -1.64  0.06 -1.19  0.01 -0.58 -0.62 -2.60 -0.94 -1.43 -1.55 
  196   197   198   199   200 
-0.45 -0.49 -0.94 -1.97 -1.13 

> fitted( x, which = "first" )
  [1] 0.57 0.05 0.20 1.05 1.11 1.34 0.07 0.06 0.27 0.03 1.16 1.18 1.03 0.04 0.05
 [16] 0.06 2.22 0.47 1.01 0.08 0.07 1.13 0.01 1.46 0.05 0.20 0.01 0.02 1.13 0.01
 [31] 1.14 0.28 0.40 1.18 0.36 0.07 1.39 2.28 2.30 0.09 0.32 0.02 0.07 0.05 0.58
 [46] 0.02 0.21 0.46 0.08 0.49 0.15 0.41 0.05 0.87 1.13 0.25 0.50 0.65 0.99 0.41
 [61] 0.29 0.53 0.77 0.06 0.75 0.78 1.14 0.03 0.01 0.22 0.18 0.10 0.37 0.07 1.25
 [76] 0.22 0.41 0.29 0.05 1.18 0.05 0.24 0.15 0.03 0.59 0.26 0.80 0.12 0.28 0.02
 [91] 1.18 0.20 0.43 2.26 0.96 0.07 0.37 0.14 0.13 0.03 0.24 2.25 0.43 1.68 0.42
[106] 0.98 0.14 1.14 0.06 0.87 0.01 1.29 1.13 0.73 0.65 1.17 1.18 2.20 0.68 0.02
[121] 0.01 0.30 0.19 0.05 2.08 0.03 0.95 0.81 0.12 0.80 0.07 0.18 0.01 1.12 0.01
[136] 1.18 0.27 0.13 0.79 0.13 0.01 0.77 0.07 0.04 0.36 0.17 0.05 0.19 0.01 0.32
[151] 0.40 0.66 0.50 0.26 0.01 0.06 0.04 0.18 0.50 0.85 0.10 0.11 1.17 2.26 0.92
[166] 0.03 1.16 0.49 0.55 1.04 0.16 0.18 0.11 0.86 1.18 1.13 0.26 1.18 0.39 1.13
[181] 0.67 0.92 0.63 1.18 0.21 0.05 1.18 0.05 0.12 1.13 0.55 0.02 0.42 0.05 0.84
[196] 0.01 0.28 1.45 1.00 0.54

> fitted( x )
  [1] 1.50 0.99 1.14 1.99 2.04 2.28 1.00 0.99 1.21 0.96 2.10 2.12 1.97 0.98 0.99
 [16] 1.00 3.16 1.41 1.94 1.02 1.01 2.06 0.95 2.40 0.98 1.13 0.95 0.95 2.07 0.95
 [31] 2.08 1.21 1.33 2.11 1.30 1.00 2.32 3.22 3.24 1.02 1.26 0.96 1.00 0.99 1.52
 [46] 0.95 1.15 1.40 1.02 1.42 1.09 1.34 0.98 1.80 2.07 1.19 1.44 1.58 1.93 1.35
 [61] 1.22 1.47 1.70 1.00 1.68 1.71 2.08 0.96 0.95 1.16 1.11 1.03 1.31 1.00 2.18
 [76] 1.15 1.35 1.22 0.99 2.11 0.99 1.18 1.08 0.96 1.52 1.19 1.74 1.05 1.21 0.96
 [91] 2.11 1.14 1.37 3.20 1.89 1.00 1.31 1.07 1.07 0.96 1.17 3.19 1.36 2.62 1.36
[106] 1.91 1.07 2.08 1.00 1.80 0.95 2.23 2.06 1.67 1.59 2.11 2.12 3.14 1.62 0.95
[121] 0.95 1.23 1.12 0.98 3.01 0.97 1.89 1.74 1.05 1.73 1.01 1.12 0.95 2.06 0.95
[136] 2.12 1.21 1.06 1.72 1.07 0.95 1.70 1.00 0.98 1.30 1.11 0.98 1.13 0.95 1.25
[151] 1.33 1.60 1.43 1.20 0.95 1.00 0.97 1.11 1.43 1.78 1.04 1.04 2.10 3.19 1.85
[166] 0.96 2.10 1.43 1.48 1.98 1.10 1.11 1.04 1.79 2.12 2.06 1.19 2.12 1.33 2.07
[181] 1.61 1.85 1.56 2.11 1.15 0.99 2.12 0.99 1.05 2.07 1.49 0.96 1.35 0.98 1.77
[196] 0.95 1.22 2.39 1.94 1.47

gradients( x )
        [,1]
  [1,]  0.83
  [2,]  0.98
  [3,]  0.92
  [4,]  0.74
  [5,]  0.65
  [6,]  0.57
  [7,]  0.97
  [8,]  0.98
  [9,]  0.89
 [10,]  0.99
 [11,]  0.47
 [12,]  0.23
 [13,]  0.76
 [14,]  0.98
 [15,]  0.98
 [16,]  0.97
 [17,]  0.22
 [18,]  0.84
 [19,]  0.78
 [20,]  0.96
 [21,]  0.97
 [22,] -0.07
 [23,]  0.99
 [24,]  0.70
 [25,]  0.98
 [26,]  0.92
 [27,]  0.99
 [28,]  0.99
 [29,] -0.15
 [30,]  0.99
 [31,]  0.05
 [32,]  0.89
 [33,]  0.86
 [34,]  0.00
 [35,]  0.87
 [36,]  0.97
 [37,]  0.64
 [38,]  0.11
 [39,]  0.22
 [40,]  0.96
 [41,]  0.88
 [42,]  0.99
 [43,]  0.97
 [44,]  0.98
 [45,]  0.83
 [46,]  0.99
 [47,]  0.91
 [48,]  0.84
 [49,]  0.97
 [50,]  0.84
 [51,]  0.94
 [52,]  0.85
 [53,]  0.98
 [54,]  0.82
 [55,] -0.15
 [56,]  0.90
 [57,]  0.84
 [58,]  0.83
 [59,]  0.79
 [60,]  0.85
 [61,]  0.89
 [62,]  0.83
 [63,]  0.83
 [64,]  0.97
 [65,]  0.83
 [66,]  0.83
 [67,]  0.54
 [68,]  0.99
 [69,]  0.99
 [70,]  0.91
 [71,]  0.93
 [72,]  0.96
 [73,]  0.86
 [74,]  0.97
 [75,]  0.39
 [76,]  0.91
 [77,]  0.85
 [78,]  0.89
 [79,]  0.98
 [80,]  0.02
 [81,]  0.98
 [82,]  0.90
 [83,]  0.94
 [84,]  0.99
 [85,]  0.83
 [86,]  0.90
 [87,]  0.83
 [88,]  0.95
 [89,]  0.89
 [90,]  0.99
 [91,]  0.36
 [92,]  0.92
 [93,]  0.85
 [94,]  0.19
 [95,]  0.80
 [96,]  0.97
 [97,]  0.86
 [98,]  0.94
 [99,]  0.94
[100,]  0.99
[101,]  0.90
[102,]  0.04
[103,]  0.85
[104,]  0.50
[105,]  0.85
[106,]  0.79
[107,]  0.94
[108,]  0.04
[109,]  0.97
[110,]  0.82
[111,]  0.99
[112,]  0.49
[113,] -0.10
[114,]  0.83
[115,]  0.83
[116,] -0.03
[117,]  0.04
[118,]  0.25
[119,]  0.83
[120,]  0.99
[121,]  0.99
[122,]  0.89
[123,]  0.92
[124,]  0.98
[125,]  0.46
[126,]  0.99
[127,]  0.80
[128,]  0.83
[129,]  0.95
[130,]  0.83
[131,]  0.97
[132,]  0.92
[133,]  0.99
[134,]  0.62
[135,]  0.99
[136,]  0.22
[137,]  0.89
[138,]  0.95
[139,]  0.83
[140,]  0.95
[141,]  0.99
[142,]  0.83
[143,]  0.97
[144,]  0.98
[145,]  0.86
[146,]  0.93
[147,]  0.98
[148,]  0.92
[149,]  0.99
[150,]  0.88
[151,]  0.86
[152,]  0.83
[153,]  0.84
[154,]  0.90
[155,]  0.99
[156,]  0.97
[157,]  0.98
[158,]  0.93
[159,]  0.84
[160,]  0.82
[161,]  0.96
[162,]  0.95
[163,] -0.07
[164,]  0.20
[165,]  0.81
[166,]  0.99
[167,]  0.13
[168,]  0.84
[169,]  0.83
[170,]  0.75
[171,]  0.93
[172,]  0.93
[173,]  0.95
[174,]  0.82
[175,]  0.23
[176,] -0.13
[177,]  0.90
[178,]  0.05
[179,]  0.86
[180,] -0.06
[181,]  0.83
[182,]  0.81
[183,]  0.83
[184,]  0.35
[185,]  0.91
[186,]  0.98
[187,]  0.06
[188,]  0.98
[189,]  0.95
[190,] -0.02
[191,]  0.83
[192,]  0.99
[193,]  0.85
[194,]  0.98
[195,]  0.82
[196,]  0.99
[197,]  0.89
[198,] -0.44
[199,]  0.78
[200,]  0.83
> 
> # local-constant regression, ls.cv bandwidths
> sfa.flw.ls <- sfaFLW( y ~ x )
Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 /Multistart 1 of 1 |Multistart 1 of 1 |                   > 
> printFLW( sfa.flw.ls )
$npreg

Regression Data: 200 training points, in 1 variable(s)
                x
Bandwidth(s): 0.2

Kernel Regression Estimator: Local-Constant
Bandwidth Type: Fixed

Continuous Kernel Type: Second-Order Gaussian
No. Continuous Explanatory Vars.: 1


$mu
[1] 0.9

$mprime
        [,1]
  [1,]  0.69
  [2,]  0.42
  [3,]  0.68
  [4,]  0.78
  [5,]  1.08
  [6,]  1.94
  [7,]  0.44
  [8,]  0.42
  [9,]  0.77
 [10,]  0.38
 [11,]  1.27
 [12,]  0.44
 [13,]  0.73
 [14,]  0.39
 [15,]  0.42
 [16,]  0.43
 [17,]  0.97
 [18,]  0.60
 [19,]  0.72
 [20,]  0.47
 [21,]  0.44
 [22,]  0.43
 [23,]  0.35
 [24,]  0.85
 [25,]  0.40
 [26,]  0.68
 [27,]  0.35
 [28,]  0.36
 [29,] -1.39
 [30,]  0.35
 [31,]  1.34
 [32,]  0.77
 [33,]  0.70
 [34,] -1.26
 [35,]  0.75
 [36,]  0.44
 [37,]  1.61
 [38,] -0.24
 [39,]  0.26
 [40,]  0.47
 [41,]  0.78
 [42,]  0.37
 [43,]  0.44
 [44,]  0.41
 [45,]  0.74
 [46,]  0.36
 [47,]  0.70
 [48,]  0.61
 [49,]  0.46
 [50,]  0.59
 [51,]  0.59
 [52,]  0.68
 [53,]  0.40
 [54,]  0.96
 [55,] -1.17
 [56,]  0.75
 [57,]  0.60
 [58,]  0.93
 [59,]  0.73
 [60,]  0.67
 [61,]  0.77
 [62,]  0.63
 [63,]  1.09
 [64,]  0.43
 [65,]  1.09
 [66,]  1.09
 [67,]  1.31
 [68,]  0.38
 [69,]  0.35
 [70,]  0.71
 [71,]  0.64
 [72,]  0.49
 [73,]  0.73
 [74,]  0.44
 [75,]  2.25
 [76,]  0.70
 [77,]  0.67
 [78,]  0.77
 [79,]  0.41
 [80,] -1.14
 [81,]  0.41
 [82,]  0.74
 [83,]  0.58
 [84,]  0.37
 [85,]  0.75
 [86,]  0.75
 [87,]  1.07
 [88,]  0.53
 [89,]  0.77
 [90,]  0.37
 [91,]  0.99
 [92,]  0.68
 [93,]  0.64
 [94,]  0.45
 [95,]  0.77
 [96,]  0.44
 [97,]  0.73
 [98,]  0.56
 [99,]  0.56
[100,]  0.37
[101,]  0.73
[102,]  0.26
[103,]  0.65
[104,] -0.15
[105,]  0.66
[106,]  0.74
[107,]  0.57
[108,]  1.29
[109,]  0.43
[110,]  0.96
[111,]  0.35
[112,]  2.17
[113,] -0.05
[114,]  1.09
[115,]  0.94
[116,] -1.57
[117,] -0.91
[118,]  0.28
[119,]  1.02
[120,]  0.36
[121,]  0.35
[122,]  0.78
[123,]  0.65
[124,]  0.41
[125,] -2.37
[126,]  0.38
[127,]  0.78
[128,]  1.06
[129,]  0.53
[130,]  1.07
[131,]  0.45
[132,]  0.65
[133,]  0.35
[134,]  1.18
[135,]  0.35
[136,]  2.03
[137,]  0.77
[138,]  0.55
[139,]  1.08
[140,]  0.55
[141,]  0.35
[142,]  1.09
[143,]  0.44
[144,]  0.40
[145,]  0.74
[146,]  0.62
[147,]  0.40
[148,]  0.67
[149,]  0.36
[150,]  0.78
[151,]  0.70
[152,]  0.97
[153,]  0.60
[154,]  0.76
[155,]  0.35
[156,]  0.43
[157,]  0.39
[158,]  0.64
[159,]  0.60
[160,]  1.00
[161,]  0.50
[162,]  0.51
[163,] -2.08
[164,]  0.66
[165,]  0.85
[166,]  0.38
[167,]  1.72
[168,]  0.59
[169,]  0.65
[170,]  0.76
[171,]  0.62
[172,]  0.64
[173,]  0.51
[174,]  0.98
[175,]  0.41
[176,] -0.68
[177,]  0.75
[178,] -0.82
[179,]  0.70
[180,]  0.55
[181,]  0.99
[182,]  0.85
[183,]  0.87
[184,]  0.95
[185,]  0.70
[186,]  0.41
[187,] -0.70
[188,]  0.41
[189,]  0.52
[190,]  0.92
[191,]  0.66
[192,]  0.37
[193,]  0.66
[194,]  0.41
[195,]  1.02
[196,]  0.35
[197,]  0.77
[198,]  0.00
[199,]  0.72
[200,]  0.63

$sigma.sq
[1] 1.55

$lambda
[1] 2.18

$sigma.u
[1] 1.13

$sigma.v
[1] 0.52

$bw
[1] 0.2

> residuals( x, which = "first" )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-1.84 -0.69  1.63  0.19  0.32  1.31  0.33 -0.50 -1.30  0.59  1.19  0.43 -0.39 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
 0.41 -0.53  0.12  0.31 -1.01 -0.20 -0.79 -0.35  0.52 -0.97 -0.59  0.14 -0.10 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
 0.62  0.20 -0.44  0.52 -0.66  0.72  1.29  0.30  0.84 -0.14  0.87 -0.12  0.05 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-0.16 -0.32  0.22 -1.52  0.96  1.53 -1.93  0.63 -0.83  0.67  0.40  0.71  0.34 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
 0.52  1.57 -0.67  1.81 -1.16  0.62  0.73 -0.62  0.63  0.14  0.66 -1.15 -2.33 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-0.67  0.75 -1.04  1.03  2.13 -0.27 -1.53  0.83 -1.07 -0.37  1.11  0.62  0.17 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
 0.56  0.48 -0.96  0.39  0.31  1.01  0.73  1.04  1.30 -0.64  0.55  1.42 -0.21 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
 0.12 -0.16 -0.66 -0.65  0.51  0.20  0.36  0.81 -1.12 -0.25 -0.05 -0.22 -0.04 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.08  0.39 -1.79  0.06 -0.69 -0.92 -0.91  0.41 -1.59  0.21  0.89  0.03  0.51 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-1.26 -1.47 -0.74  0.71 -0.96 -0.83  0.03  0.68 -0.25  0.88  0.21 -1.13  0.84 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
 0.66 -0.09  0.12 -1.29 -0.76 -0.48 -1.44  1.19  1.07 -0.02  0.63 -0.34 -1.91 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.05 -0.03 -1.33 -0.06  0.75  1.08  0.01  0.32 -0.83  0.72  0.25 -0.17  0.39 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
 0.80  0.72 -1.21 -2.29  1.36 -0.41 -0.33  1.18 -0.36  0.87  1.20 -0.37  0.34 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
 0.47 -1.90 -0.85  0.41  1.20 -0.54 -0.01 -0.11  0.58  1.24 -0.96  0.29  1.37 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
 0.58 -1.20  0.31 -0.75  0.70 -0.30  0.93  0.64  0.40 -1.73  0.05 -0.55 -0.58 
  196   197   198   199   200 
 0.41  0.48  0.00 -1.02 -0.12 

> residuals( x )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-2.74 -1.60  0.73 -0.72 -0.58  0.41 -0.58 -1.40 -2.20 -0.31  0.28 -0.47 -1.29 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
-0.49 -1.43 -0.79 -0.59 -1.92 -1.10 -1.70 -1.26 -0.38 -1.87 -1.49 -0.76 -1.00 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
-0.28 -0.71 -1.34 -0.39 -1.57 -0.19  0.39 -0.60 -0.06 -1.04 -0.03 -1.02 -0.85 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-1.07 -1.22 -0.68 -2.42  0.05  0.62 -2.83 -0.27 -1.73 -0.24 -0.50 -0.20 -0.56 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
-0.39  0.67 -1.57  0.91 -2.07 -0.29 -0.17 -1.52 -0.27 -0.76 -0.25 -2.06 -3.24 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-1.58 -0.15 -1.94  0.13  1.23 -1.18 -2.44 -0.08 -1.97 -1.28  0.20 -0.28 -0.73 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
-0.34 -0.42 -1.86 -0.51 -0.59  0.11 -0.17  0.14  0.40 -1.54 -0.35  0.52 -1.11 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
-0.78 -1.06 -1.56 -1.56 -0.40 -0.71 -0.54 -0.10 -2.02 -1.15 -0.96 -1.12 -0.94 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.98 -0.51 -2.69 -0.84 -1.60 -1.82 -1.82 -0.49 -2.50 -0.69 -0.01 -0.87 -0.39 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-2.17 -2.37 -1.64 -0.19 -1.86 -1.73 -0.87 -0.22 -1.15 -0.02 -0.69 -2.04 -0.06 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
-0.24 -0.99 -0.78 -2.20 -1.66 -1.38 -2.34  0.29  0.17 -0.92 -0.27 -1.24 -2.81 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.95 -0.93 -2.23 -0.97 -0.15  0.18 -0.89 -0.58 -1.73 -0.19 -0.65 -1.08 -0.51 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
-0.10 -0.18 -2.11 -3.20  0.46 -1.31 -1.23  0.28 -1.26 -0.04  0.30 -1.27 -0.56 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
-0.44 -2.80 -1.76 -0.49  0.30 -1.44 -0.92 -1.02 -0.32  0.34 -1.87 -0.61  0.47 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
-0.32 -2.11 -0.59 -1.65 -0.20 -1.21  0.02 -0.26 -0.51 -2.63 -0.85 -1.45 -1.48 
  196   197   198   199   200 
-0.49 -0.42 -0.90 -1.92 -1.02 

> fitted( x, which = "first" )
  [1] 0.48 0.10 0.19 1.05 1.15 1.46 0.11 0.10 0.24 0.09 1.34 1.49 1.02 0.10 0.10
 [16] 0.10 2.14 0.41 0.99 0.11 0.11 0.82 0.09 1.65 0.10 0.18 0.09 0.09 0.87 0.09
 [31] 0.89 0.25 0.35 1.43 0.32 0.11 1.55 2.33 2.30 0.12 0.29 0.09 0.11 0.10 0.50
 [46] 0.09 0.19 0.40 0.11 0.42 0.15 0.36 0.10 0.84 0.85 0.22 0.43 0.56 0.98 0.37
 [61] 0.25 0.46 0.71 0.10 0.69 0.73 1.26 0.09 0.09 0.20 0.17 0.12 0.33 0.11 1.24
 [76] 0.20 0.36 0.25 0.10 1.45 0.10 0.21 0.15 0.09 0.50 0.23 0.76 0.13 0.25 0.09
 [91] 1.43 0.18 0.38 2.32 0.94 0.11 0.33 0.14 0.14 0.09 0.21 2.22 0.38 1.07 0.37
[106] 0.96 0.14 0.88 0.11 0.84 0.09 1.36 0.81 0.67 0.56 1.40 1.46 2.08 0.60 0.09
[121] 0.09 0.26 0.17 0.10 2.42 0.09 0.93 0.77 0.13 0.75 0.11 0.17 0.09 1.18 0.09
[136] 1.05 0.24 0.14 0.74 0.14 0.09 0.71 0.11 0.10 0.32 0.16 0.10 0.18 0.09 0.28
[151] 0.35 0.58 0.43 0.23 0.09 0.11 0.10 0.17 0.43 0.81 0.12 0.13 1.32 2.29 0.90
[166] 0.09 0.96 0.43 0.46 1.04 0.16 0.17 0.13 0.83 1.49 0.83 0.23 1.47 0.35 0.82
[181] 0.59 0.90 0.54 1.43 0.19 0.10 1.48 0.10 0.13 0.85 0.47 0.09 0.37 0.10 0.80
[196] 0.09 0.25 1.45 0.99 0.46

> fitted( x )
  [1] 1.38 1.00 1.09 1.95 2.05 2.36 1.01 1.01 1.15 0.99 2.24 2.39 1.92 1.00 1.00
 [16] 1.01 3.04 1.31 1.90 1.02 1.01 1.72 0.99 2.56 1.00 1.09 0.99 0.99 1.78 0.99
 [31] 1.79 1.15 1.25 2.34 1.22 1.01 2.45 3.23 3.20 1.02 1.19 0.99 1.01 1.00 1.40
 [46] 0.99 1.10 1.30 1.02 1.32 1.05 1.26 1.00 1.74 1.76 1.13 1.34 1.46 1.88 1.27
 [61] 1.16 1.36 1.61 1.01 1.59 1.63 2.17 0.99 0.99 1.10 1.07 1.02 1.23 1.01 2.14
 [76] 1.10 1.27 1.16 1.00 2.35 1.00 1.12 1.05 0.99 1.40 1.13 1.66 1.03 1.15 0.99
 [91] 2.33 1.09 1.28 3.22 1.85 1.01 1.23 1.04 1.04 0.99 1.12 3.12 1.28 1.98 1.27
[106] 1.86 1.05 1.79 1.01 1.75 0.99 2.26 1.71 1.57 1.47 2.30 2.37 2.98 1.51 0.99
[121] 0.99 1.16 1.08 1.00 3.33 1.00 1.84 1.67 1.03 1.66 1.01 1.08 0.99 2.08 0.99
[136] 1.96 1.15 1.04 1.64 1.04 0.99 1.61 1.01 1.00 1.23 1.06 1.00 1.08 0.99 1.18
[151] 1.25 1.48 1.33 1.13 0.99 1.01 1.00 1.07 1.33 1.72 1.03 1.03 2.22 3.20 1.80
[166] 0.99 1.86 1.33 1.37 1.94 1.06 1.07 1.03 1.73 2.39 1.73 1.13 2.37 1.25 1.72
[181] 1.49 1.80 1.44 2.34 1.10 1.00 2.38 1.00 1.03 1.75 1.37 0.99 1.27 1.00 1.71
[196] 0.99 1.15 2.35 1.89 1.36

gradients( x )
        [,1]
  [1,]  0.69
  [2,]  0.42
  [3,]  0.68
  [4,]  0.78
  [5,]  1.08
  [6,]  1.94
  [7,]  0.44
  [8,]  0.42
  [9,]  0.77
 [10,]  0.38
 [11,]  1.27
 [12,]  0.44
 [13,]  0.73
 [14,]  0.39
 [15,]  0.42
 [16,]  0.43
 [17,]  0.97
 [18,]  0.60
 [19,]  0.72
 [20,]  0.47
 [21,]  0.44
 [22,]  0.43
 [23,]  0.35
 [24,]  0.85
 [25,]  0.40
 [26,]  0.68
 [27,]  0.35
 [28,]  0.36
 [29,] -1.39
 [30,]  0.35
 [31,]  1.34
 [32,]  0.77
 [33,]  0.70
 [34,] -1.26
 [35,]  0.75
 [36,]  0.44
 [37,]  1.61
 [38,] -0.24
 [39,]  0.26
 [40,]  0.47
 [41,]  0.78
 [42,]  0.37
 [43,]  0.44
 [44,]  0.41
 [45,]  0.74
 [46,]  0.36
 [47,]  0.70
 [48,]  0.61
 [49,]  0.46
 [50,]  0.59
 [51,]  0.59
 [52,]  0.68
 [53,]  0.40
 [54,]  0.96
 [55,] -1.17
 [56,]  0.75
 [57,]  0.60
 [58,]  0.93
 [59,]  0.73
 [60,]  0.67
 [61,]  0.77
 [62,]  0.63
 [63,]  1.09
 [64,]  0.43
 [65,]  1.09
 [66,]  1.09
 [67,]  1.31
 [68,]  0.38
 [69,]  0.35
 [70,]  0.71
 [71,]  0.64
 [72,]  0.49
 [73,]  0.73
 [74,]  0.44
 [75,]  2.25
 [76,]  0.70
 [77,]  0.67
 [78,]  0.77
 [79,]  0.41
 [80,] -1.14
 [81,]  0.41
 [82,]  0.74
 [83,]  0.58
 [84,]  0.37
 [85,]  0.75
 [86,]  0.75
 [87,]  1.07
 [88,]  0.53
 [89,]  0.77
 [90,]  0.37
 [91,]  0.99
 [92,]  0.68
 [93,]  0.64
 [94,]  0.45
 [95,]  0.77
 [96,]  0.44
 [97,]  0.73
 [98,]  0.56
 [99,]  0.56
[100,]  0.37
[101,]  0.73
[102,]  0.26
[103,]  0.65
[104,] -0.15
[105,]  0.66
[106,]  0.74
[107,]  0.57
[108,]  1.29
[109,]  0.43
[110,]  0.96
[111,]  0.35
[112,]  2.17
[113,] -0.05
[114,]  1.09
[115,]  0.94
[116,] -1.57
[117,] -0.91
[118,]  0.28
[119,]  1.02
[120,]  0.36
[121,]  0.35
[122,]  0.78
[123,]  0.65
[124,]  0.41
[125,] -2.37
[126,]  0.38
[127,]  0.78
[128,]  1.06
[129,]  0.53
[130,]  1.07
[131,]  0.45
[132,]  0.65
[133,]  0.35
[134,]  1.18
[135,]  0.35
[136,]  2.03
[137,]  0.77
[138,]  0.55
[139,]  1.08
[140,]  0.55
[141,]  0.35
[142,]  1.09
[143,]  0.44
[144,]  0.40
[145,]  0.74
[146,]  0.62
[147,]  0.40
[148,]  0.67
[149,]  0.36
[150,]  0.78
[151,]  0.70
[152,]  0.97
[153,]  0.60
[154,]  0.76
[155,]  0.35
[156,]  0.43
[157,]  0.39
[158,]  0.64
[159,]  0.60
[160,]  1.00
[161,]  0.50
[162,]  0.51
[163,] -2.08
[164,]  0.66
[165,]  0.85
[166,]  0.38
[167,]  1.72
[168,]  0.59
[169,]  0.65
[170,]  0.76
[171,]  0.62
[172,]  0.64
[173,]  0.51
[174,]  0.98
[175,]  0.41
[176,] -0.68
[177,]  0.75
[178,] -0.82
[179,]  0.70
[180,]  0.55
[181,]  0.99
[182,]  0.85
[183,]  0.87
[184,]  0.95
[185,]  0.70
[186,]  0.41
[187,] -0.70
[188,]  0.41
[189,]  0.52
[190,]  0.92
[191,]  0.66
[192,]  0.37
[193,]  0.66
[194,]  0.41
[195,]  1.02
[196,]  0.35
[197,]  0.77
[198,]  0.00
[199,]  0.72
[200,]  0.63
> 
> # local-linear regression, ls.cv bandwidths
> sfa.flw.ll.ls <- sfaFLW( y ~ x, npArg = list( regtype = "ll" ) )
Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 /Multistart 1 of 1 |Multistart 1 of 1 |                   > 
> printFLW( sfa.flw.ll.ls )
$npreg

Regression Data: 200 training points, in 1 variable(s)
                 x
Bandwidth(s): 1.14

Kernel Regression Estimator: Local-Linear
Bandwidth Type: Fixed

Continuous Kernel Type: Second-Order Gaussian
No. Continuous Explanatory Vars.: 1


$mu
[1] 0.93

$mprime
        [,1]
  [1,]  0.67
  [2,]  0.73
  [3,]  0.72
  [4,]  0.59
  [5,]  0.58
  [6,]  0.45
  [7,]  0.73
  [8,]  0.73
  [9,]  0.71
 [10,]  0.74
 [11,]  0.56
 [12,]  0.54
 [13,]  0.59
 [14,]  0.74
 [15,]  0.73
 [16,]  0.73
 [17,]  0.41
 [18,]  0.68
 [19,]  0.60
 [20,]  0.73
 [21,]  0.73
 [22,]  0.48
 [23,]  0.74
 [24,]  0.44
 [25,]  0.74
 [26,]  0.72
 [27,]  0.74
 [28,]  0.74
 [29,]  0.49
 [30,]  0.74
 [31,]  0.47
 [32,]  0.71
 [33,]  0.69
 [34,]  0.52
 [35,]  0.70
 [36,]  0.73
 [37,]  0.44
 [38,]  0.37
 [39,]  0.06
 [40,]  0.73
 [41,]  0.70
 [42,]  0.74
 [43,]  0.73
 [44,]  0.73
 [45,]  0.66
 [46,]  0.74
 [47,]  0.72
 [48,]  0.68
 [49,]  0.73
 [50,]  0.68
 [51,]  0.72
 [52,]  0.69
 [53,]  0.74
 [54,]  0.62
 [55,]  0.49
 [56,]  0.71
 [57,]  0.68
 [58,]  0.65
 [59,]  0.60
 [60,]  0.69
 [61,]  0.71
 [62,]  0.67
 [63,]  0.64
 [64,]  0.73
 [65,]  0.64
 [66,]  0.64
 [67,]  0.56
 [68,]  0.74
 [69,]  0.74
 [70,]  0.71
 [71,]  0.72
 [72,]  0.73
 [73,]  0.70
 [74,]  0.73
 [75,]  0.46
 [76,]  0.72
 [77,]  0.69
 [78,]  0.71
 [79,]  0.73
 [80,]  0.52
 [81,]  0.73
 [82,]  0.71
 [83,]  0.72
 [84,]  0.74
 [85,]  0.66
 [86,]  0.71
 [87,]  0.63
 [88,]  0.73
 [89,]  0.71
 [90,]  0.74
 [91,]  0.55
 [92,]  0.72
 [93,]  0.69
 [94,]  0.39
 [95,]  0.61
 [96,]  0.73
 [97,]  0.69
 [98,]  0.73
 [99,]  0.73
[100,]  0.74
[101,]  0.71
[102,]  0.16
[103,]  0.69
[104,]  0.42
[105,]  0.69
[106,]  0.60
[107,]  0.73
[108,]  0.47
[109,]  0.73
[110,]  0.62
[111,]  0.74
[112,]  0.45
[113,]  0.48
[114,]  0.64
[115,]  0.65
[116,]  0.52
[117,]  0.52
[118,]  0.41
[119,]  0.65
[120,]  0.74
[121,]  0.74
[122,]  0.71
[123,]  0.72
[124,]  0.74
[125,]  0.42
[126,]  0.74
[127,]  0.61
[128,]  0.63
[129,]  0.73
[130,]  0.63
[131,]  0.73
[132,]  0.72
[133,]  0.74
[134,]  0.57
[135,]  0.74
[136,]  0.46
[137,]  0.71
[138,]  0.73
[139,]  0.63
[140,]  0.73
[141,]  0.74
[142,]  0.64
[143,]  0.73
[144,]  0.74
[145,]  0.70
[146,]  0.72
[147,]  0.74
[148,]  0.72
[149,]  0.74
[150,]  0.70
[151,]  0.69
[152,]  0.65
[153,]  0.68
[154,]  0.71
[155,]  0.74
[156,]  0.73
[157,]  0.74
[158,]  0.72
[159,]  0.68
[160,]  0.63
[161,]  0.73
[162,]  0.73
[163,]  0.51
[164,]  0.40
[165,]  0.61
[166,]  0.74
[167,]  0.47
[168,]  0.68
[169,]  0.67
[170,]  0.59
[171,]  0.72
[172,]  0.72
[173,]  0.73
[174,]  0.62
[175,]  0.54
[176,]  0.49
[177,]  0.71
[178,]  0.52
[179,]  0.69
[180,]  0.48
[181,]  0.65
[182,]  0.61
[183,]  0.66
[184,]  0.55
[185,]  0.72
[186,]  0.73
[187,]  0.52
[188,]  0.73
[189,]  0.73
[190,]  0.47
[191,]  0.67
[192,]  0.74
[193,]  0.69
[194,]  0.73
[195,]  0.63
[196,]  0.74
[197,]  0.71
[198,] -0.33
[199,]  0.60
[200,]  0.67

$sigma.sq
[1] 1.65

$lambda
[1] 2.21

$sigma.u
[1] 1.17

$sigma.v
[1] 0.53

$bw
[1] 1.14

> residuals( x, which = "first" )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-1.86 -0.69  1.61  0.36  0.53  1.33  0.33 -0.50 -1.32  0.61  1.52  0.85 -0.22 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
 0.42 -0.52  0.12  0.36 -1.03 -0.04 -0.80 -0.35  0.03 -0.95 -0.42  0.15 -0.12 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
 0.64  0.22 -0.82  0.54 -1.10  0.69  1.28  0.58  0.82 -0.13  0.96  0.00  0.14 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-0.17 -0.34  0.24 -1.52  0.96  1.50 -1.91  0.61 -0.85  0.67  0.38  0.69  0.32 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
 0.53  1.68 -1.08  1.79 -1.19  0.61  0.89 -0.63  0.61  0.12  0.71 -1.15 -2.29 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-0.61  1.04 -1.03  1.05  2.11 -0.29 -1.54  0.81 -1.07 -0.54  1.08  0.61  0.15 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
 0.57  0.78 -0.95  0.37  0.30  1.03  0.71  1.02  1.37 -0.65  0.53  1.44  0.18 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
 0.10 -0.18 -0.50 -0.51  0.51  0.18  0.35  0.79 -1.10 -0.27 -0.11 -0.24 -0.66 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.09  0.54 -1.81 -0.39 -0.69 -0.81 -0.89  0.35 -2.07  0.25  0.88  0.27  0.84 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-1.24 -1.46 -0.72  0.74 -0.98 -0.85  0.04  1.15 -0.23  1.02  0.29 -1.15  0.91 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
 0.67 -0.11  0.14 -1.06 -0.73 -0.80 -1.46  1.18  1.13 -0.03  0.65 -0.29 -1.90 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.04 -0.05 -1.35 -0.05  0.73  1.10 -0.01  0.30 -0.83  0.69  0.23 -0.15  0.40 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
 0.81  0.70 -1.24 -2.19  1.36 -0.42 -0.18  1.34 -0.23  0.88  0.81 -0.39  0.31 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
 0.64 -1.92 -0.87  0.41  1.30 -0.12 -0.46 -0.14  0.92  1.23 -1.45  0.29  1.50 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
 0.56 -0.81  0.28 -0.74  1.05 -0.30  0.92  0.17  0.37 -1.71  0.03 -0.54 -0.49 
  196   197   198   199   200 
 0.43  0.46 -0.02 -0.86 -0.14 

> residuals( x )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-2.80 -1.62  0.68 -0.57 -0.40  0.40 -0.60 -1.43 -2.25 -0.32  0.59 -0.09 -1.15 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
-0.51 -1.45 -0.81 -0.57 -1.97 -0.97 -1.73 -1.28 -0.90 -1.88 -1.36 -0.78 -1.06 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
-0.29 -0.72 -1.75 -0.39 -2.04 -0.24  0.34 -0.35 -0.11 -1.07  0.03 -0.93 -0.80 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-1.10 -1.27 -0.69 -2.45  0.03  0.57 -2.84 -0.32 -1.78 -0.27 -0.56 -0.25 -0.61 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
-0.41  0.75 -2.01  0.85 -2.12 -0.33 -0.04 -1.57 -0.32 -0.82 -0.23 -2.08 -3.23 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-1.55  0.11 -1.96  0.12  1.17 -1.23 -2.47 -0.13 -2.00 -1.47  0.15 -0.33 -0.78 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
-0.37 -0.15 -1.88 -0.57 -0.64  0.09 -0.23  0.09  0.44 -1.58 -0.41  0.51 -0.75 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
-0.83 -1.11 -1.44 -1.44 -0.42 -0.76 -0.58 -0.14 -2.04 -1.21 -1.05 -1.17 -1.59 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-1.03 -0.39 -2.74 -1.32 -1.62 -1.74 -1.82 -0.58 -3.01 -0.69 -0.05 -0.66 -0.09 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-2.17 -2.39 -1.65 -0.20 -1.92 -1.79 -0.90  0.22 -1.16  0.09 -0.65 -2.08 -0.02 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
-0.27 -1.05 -0.79 -1.99 -1.67 -1.73 -2.40  0.24  0.20 -0.97 -0.28 -1.22 -2.84 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.97 -0.98 -2.29 -0.99 -0.20  0.17 -0.94 -0.63 -1.76 -0.24 -0.70 -1.08 -0.54 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
-0.12 -0.23 -2.17 -3.13  0.42 -1.35 -1.12  0.40 -1.17 -0.05 -0.12 -1.32 -0.62 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
-0.30 -2.85 -1.81 -0.53  0.37 -1.06 -1.39 -1.07 -0.01  0.29 -2.38 -0.65  0.56 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
-0.37 -1.75 -0.65 -1.68  0.12 -1.23 -0.02 -0.76 -0.56 -2.64 -0.90 -1.47 -1.42 
  196   197   198   199   200 
-0.50 -0.48 -0.95 -1.80 -1.08 

> fitted( x, which = "first" )
  [1] 0.51 0.09 0.21 0.88 0.93 1.44 0.10 0.10 0.27 0.08 1.00 1.08 0.85 0.08 0.09
 [16] 0.10 2.09 0.43 0.84 0.12 0.11 1.30 0.06 1.49 0.09 0.21 0.06 0.07 1.26 0.06
 [31] 1.33 0.27 0.37 1.15 0.34 0.10 1.46 2.21 2.22 0.12 0.31 0.07 0.11 0.09 0.52
 [46] 0.07 0.22 0.42 0.11 0.44 0.17 0.38 0.09 0.73 1.26 0.25 0.46 0.57 0.82 0.38
 [61] 0.28 0.48 0.66 0.10 0.65 0.67 0.98 0.08 0.06 0.23 0.19 0.13 0.35 0.10 1.40
 [76] 0.22 0.38 0.28 0.09 1.14 0.09 0.24 0.16 0.07 0.52 0.25 0.68 0.14 0.27 0.07
 [91] 1.04 0.21 0.40 2.16 0.80 0.10 0.35 0.16 0.16 0.07 0.24 2.28 0.39 1.69 0.39
[106] 0.81 0.16 1.33 0.10 0.73 0.06 1.42 1.29 0.64 0.57 1.16 1.14 2.06 0.60 0.07
[121] 0.06 0.29 0.20 0.09 1.96 0.08 0.79 0.69 0.14 0.68 0.11 0.20 0.07 0.94 0.06
[136] 1.37 0.27 0.15 0.67 0.15 0.06 0.66 0.10 0.08 0.34 0.18 0.09 0.20 0.07 0.30
[151] 0.37 0.58 0.45 0.26 0.06 0.10 0.08 0.19 0.45 0.72 0.13 0.14 1.18 2.14 0.77
[166] 0.08 1.35 0.45 0.49 0.87 0.18 0.19 0.14 0.72 1.08 1.27 0.25 1.13 0.36 1.31
[181] 0.59 0.77 0.56 1.04 0.22 0.09 1.13 0.09 0.14 1.32 0.49 0.07 0.39 0.09 0.71
[196] 0.06 0.27 1.47 0.83 0.48

> fitted( x )
  [1] 1.44 1.03 1.14 1.81 1.86 2.37 1.04 1.03 1.20 1.01 1.94 2.01 1.79 1.02 1.03
 [16] 1.03 3.02 1.36 1.77 1.05 1.04 2.24 1.00 2.42 1.02 1.14 1.00 1.00 2.19 1.00
 [31] 2.27 1.20 1.30 2.08 1.27 1.04 2.39 3.14 3.15 1.05 1.24 1.00 1.04 1.03 1.45
 [46] 1.00 1.15 1.36 1.05 1.38 1.10 1.31 1.02 1.67 2.20 1.18 1.39 1.50 1.76 1.32
 [61] 1.21 1.42 1.59 1.03 1.58 1.60 1.91 1.01 1.00 1.16 1.12 1.06 1.28 1.04 2.33
 [76] 1.15 1.31 1.21 1.03 2.08 1.03 1.17 1.10 1.01 1.46 1.19 1.62 1.08 1.20 1.00
 [91] 1.97 1.14 1.33 3.09 1.73 1.04 1.28 1.09 1.09 1.01 1.17 3.21 1.33 2.63 1.32
[106] 1.75 1.09 2.27 1.04 1.67 1.00 2.35 2.22 1.57 1.51 2.09 2.07 2.99 1.53 1.00
[121] 1.00 1.22 1.13 1.02 2.89 1.01 1.73 1.62 1.07 1.62 1.04 1.13 1.00 1.88 1.00
[136] 2.30 1.20 1.08 1.61 1.09 1.00 1.59 1.04 1.02 1.27 1.12 1.02 1.14 1.00 1.24
[151] 1.30 1.51 1.39 1.19 1.00 1.03 1.01 1.12 1.38 1.65 1.07 1.07 2.11 3.08 1.70
[166] 1.01 2.28 1.38 1.42 1.80 1.11 1.12 1.07 1.66 2.01 2.21 1.19 2.07 1.30 2.24
[181] 1.52 1.70 1.49 1.98 1.15 1.03 2.06 1.03 1.07 2.25 1.43 1.01 1.32 1.02 1.64
[196] 1.00 1.20 2.40 1.77 1.42

gradients( x )
        [,1]
  [1,]  0.67
  [2,]  0.73
  [3,]  0.72
  [4,]  0.59
  [5,]  0.58
  [6,]  0.45
  [7,]  0.73
  [8,]  0.73
  [9,]  0.71
 [10,]  0.74
 [11,]  0.56
 [12,]  0.54
 [13,]  0.59
 [14,]  0.74
 [15,]  0.73
 [16,]  0.73
 [17,]  0.41
 [18,]  0.68
 [19,]  0.60
 [20,]  0.73
 [21,]  0.73
 [22,]  0.48
 [23,]  0.74
 [24,]  0.44
 [25,]  0.74
 [26,]  0.72
 [27,]  0.74
 [28,]  0.74
 [29,]  0.49
 [30,]  0.74
 [31,]  0.47
 [32,]  0.71
 [33,]  0.69
 [34,]  0.52
 [35,]  0.70
 [36,]  0.73
 [37,]  0.44
 [38,]  0.37
 [39,]  0.06
 [40,]  0.73
 [41,]  0.70
 [42,]  0.74
 [43,]  0.73
 [44,]  0.73
 [45,]  0.66
 [46,]  0.74
 [47,]  0.72
 [48,]  0.68
 [49,]  0.73
 [50,]  0.68
 [51,]  0.72
 [52,]  0.69
 [53,]  0.74
 [54,]  0.62
 [55,]  0.49
 [56,]  0.71
 [57,]  0.68
 [58,]  0.65
 [59,]  0.60
 [60,]  0.69
 [61,]  0.71
 [62,]  0.67
 [63,]  0.64
 [64,]  0.73
 [65,]  0.64
 [66,]  0.64
 [67,]  0.56
 [68,]  0.74
 [69,]  0.74
 [70,]  0.71
 [71,]  0.72
 [72,]  0.73
 [73,]  0.70
 [74,]  0.73
 [75,]  0.46
 [76,]  0.72
 [77,]  0.69
 [78,]  0.71
 [79,]  0.73
 [80,]  0.52
 [81,]  0.73
 [82,]  0.71
 [83,]  0.72
 [84,]  0.74
 [85,]  0.66
 [86,]  0.71
 [87,]  0.63
 [88,]  0.73
 [89,]  0.71
 [90,]  0.74
 [91,]  0.55
 [92,]  0.72
 [93,]  0.69
 [94,]  0.39
 [95,]  0.61
 [96,]  0.73
 [97,]  0.69
 [98,]  0.73
 [99,]  0.73
[100,]  0.74
[101,]  0.71
[102,]  0.16
[103,]  0.69
[104,]  0.42
[105,]  0.69
[106,]  0.60
[107,]  0.73
[108,]  0.47
[109,]  0.73
[110,]  0.62
[111,]  0.74
[112,]  0.45
[113,]  0.48
[114,]  0.64
[115,]  0.65
[116,]  0.52
[117,]  0.52
[118,]  0.41
[119,]  0.65
[120,]  0.74
[121,]  0.74
[122,]  0.71
[123,]  0.72
[124,]  0.74
[125,]  0.42
[126,]  0.74
[127,]  0.61
[128,]  0.63
[129,]  0.73
[130,]  0.63
[131,]  0.73
[132,]  0.72
[133,]  0.74
[134,]  0.57
[135,]  0.74
[136,]  0.46
[137,]  0.71
[138,]  0.73
[139,]  0.63
[140,]  0.73
[141,]  0.74
[142,]  0.64
[143,]  0.73
[144,]  0.74
[145,]  0.70
[146,]  0.72
[147,]  0.74
[148,]  0.72
[149,]  0.74
[150,]  0.70
[151,]  0.69
[152,]  0.65
[153,]  0.68
[154,]  0.71
[155,]  0.74
[156,]  0.73
[157,]  0.74
[158,]  0.72
[159,]  0.68
[160,]  0.63
[161,]  0.73
[162,]  0.73
[163,]  0.51
[164,]  0.40
[165,]  0.61
[166,]  0.74
[167,]  0.47
[168,]  0.68
[169,]  0.67
[170,]  0.59
[171,]  0.72
[172,]  0.72
[173,]  0.73
[174,]  0.62
[175,]  0.54
[176,]  0.49
[177,]  0.71
[178,]  0.52
[179,]  0.69
[180,]  0.48
[181,]  0.65
[182,]  0.61
[183,]  0.66
[184,]  0.55
[185,]  0.72
[186,]  0.73
[187,]  0.52
[188,]  0.73
[189,]  0.73
[190,]  0.47
[191,]  0.67
[192,]  0.74
[193,]  0.69
[194,]  0.73
[195,]  0.63
[196,]  0.74
[197,]  0.71
[198,] -0.33
[199,]  0.60
[200,]  0.67
> 
> # local-constant regression, aic bandwidths
> sfa.flw.aic <- sfaFLW( y ~ x, bwmethod = "cv.aic" )
Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 /Multistart 1 of 1 |Multistart 1 of 1 |                   > 
> printFLW( sfa.flw.aic )
$npreg

Regression Data: 200 training points, in 1 variable(s)
                 x
Bandwidth(s): 0.22

Kernel Regression Estimator: Local-Constant
Bandwidth Type: Fixed

Continuous Kernel Type: Second-Order Gaussian
No. Continuous Explanatory Vars.: 1


$mu
[1] 0.91

$mprime
        [,1]
  [1,]  0.76
  [2,]  0.38
  [3,]  0.57
  [4,]  0.86
  [5,]  1.07
  [6,]  1.69
  [7,]  0.39
  [8,]  0.38
  [9,]  0.64
 [10,]  0.35
 [11,]  1.14
 [12,]  0.28
 [13,]  0.81
 [14,]  0.36
 [15,]  0.38
 [16,]  0.39
 [17,]  0.59
 [18,]  0.68
 [19,]  0.79
 [20,]  0.41
 [21,]  0.40
 [22,]  0.21
 [23,]  0.33
 [24,]  0.98
 [25,]  0.37
 [26,]  0.56
 [27,]  0.33
 [28,]  0.34
 [29,] -1.13
 [30,]  0.33
 [31,]  0.99
 [32,]  0.65
 [33,]  0.69
 [34,] -1.16
 [35,]  0.69
 [36,]  0.39
 [37,]  1.50
 [38,] -0.06
 [39,]  0.22
 [40,]  0.42
 [41,]  0.68
 [42,]  0.34
 [43,]  0.40
 [44,]  0.38
 [45,]  0.79
 [46,]  0.34
 [47,]  0.58
 [48,]  0.68
 [49,]  0.41
 [50,]  0.69
 [51,]  0.50
 [52,]  0.69
 [53,]  0.37
 [54,]  0.93
 [55,] -0.98
 [56,]  0.62
 [57,]  0.70
 [58,]  0.91
 [59,]  0.79
 [60,]  0.69
 [61,]  0.65
 [62,]  0.72
 [63,]  1.02
 [64,]  0.39
 [65,]  1.02
 [66,]  1.02
 [67,]  1.20
 [68,]  0.35
 [69,]  0.33
 [70,]  0.59
 [71,]  0.53
 [72,]  0.43
 [73,]  0.69
 [74,]  0.39
 [75,]  1.81
 [76,]  0.58
 [77,]  0.69
 [78,]  0.65
 [79,]  0.37
 [80,] -1.07
 [81,]  0.37
 [82,]  0.61
 [83,]  0.49
 [84,]  0.35
 [85,]  0.80
 [86,]  0.63
 [87,]  1.00
 [88,]  0.46
 [89,]  0.65
 [90,]  0.34
 [91,]  0.83
 [92,]  0.56
 [93,]  0.68
 [94,]  0.43
 [95,]  0.81
 [96,]  0.39
 [97,]  0.69
 [98,]  0.48
 [99,]  0.48
[100,]  0.35
[101,]  0.61
[102,]  0.22
[103,]  0.68
[104,] -0.24
[105,]  0.69
[106,]  0.80
[107,]  0.48
[108,]  0.94
[109,]  0.39
[110,]  0.93
[111,]  0.33
[112,]  1.80
[113,] -0.16
[114,]  1.01
[115,]  0.91
[116,] -1.37
[117,] -0.90
[118,]  0.13
[119,]  0.97
[120,]  0.34
[121,]  0.33
[122,]  0.66
[123,]  0.54
[124,]  0.37
[125,] -1.58
[126,]  0.35
[127,]  0.82
[128,]  1.00
[129,]  0.45
[130,]  1.01
[131,]  0.40
[132,]  0.54
[133,]  0.33
[134,]  1.13
[135,]  0.33
[136,]  1.58
[137,]  0.64
[138,]  0.47
[139,]  1.01
[140,]  0.47
[141,]  0.33
[142,]  1.02
[143,]  0.39
[144,]  0.36
[145,]  0.69
[146,]  0.52
[147,]  0.37
[148,]  0.55
[149,]  0.33
[150,]  0.67
[151,]  0.69
[152,]  0.93
[153,]  0.69
[154,]  0.63
[155,]  0.33
[156,]  0.39
[157,]  0.36
[158,]  0.54
[159,]  0.69
[160,]  0.96
[161,]  0.44
[162,]  0.45
[163,] -1.69
[164,]  0.54
[165,]  0.86
[166,]  0.35
[167,]  1.31
[168,]  0.69
[169,]  0.74
[170,]  0.83
[171,]  0.52
[172,]  0.54
[173,]  0.44
[174,]  0.94
[175,]  0.25
[176,] -0.63
[177,]  0.63
[178,] -0.83
[179,]  0.69
[180,]  0.32
[181,]  0.95
[182,]  0.86
[183,]  0.87
[184,]  0.80
[185,]  0.58
[186,]  0.38
[187,] -0.73
[188,]  0.38
[189,]  0.45
[190,]  0.62
[191,]  0.74
[192,]  0.34
[193,]  0.69
[194,]  0.37
[195,]  0.97
[196,]  0.33
[197,]  0.65
[198,]  0.00
[199,]  0.79
[200,]  0.72

$sigma.sq
[1] 1.56

$lambda
[1] 2.18

$sigma.u
[1] 1.14

$sigma.v
[1] 0.52

$bw
[1] 0.22

> residuals( x, which = "first" )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-1.83 -0.71  1.63  0.20  0.32  1.39  0.31 -0.51 -1.29  0.58  1.20  0.48 -0.37 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
 0.40 -0.54  0.10  0.29 -1.00 -0.18 -0.81 -0.37  0.45 -0.98 -0.50  0.13 -0.10 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
 0.61  0.18 -0.50  0.50 -0.70  0.72  1.31  0.35  0.86 -0.15  0.96 -0.11  0.06 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-0.18 -0.31  0.21 -1.53  0.94  1.53 -1.94  0.63 -0.81  0.65  0.41  0.70  0.36 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
 0.50  1.59 -0.74  1.82 -1.15  0.62  0.75 -0.60  0.64  0.15  0.67 -1.17 -2.32 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-0.66  0.76 -1.06  1.02  2.13 -0.28 -1.54  0.84 -1.09 -0.34  1.11  0.64  0.18 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
 0.55  0.54 -0.97  0.39  0.31  1.00  0.74  1.05  1.31 -0.65  0.56  1.41 -0.18 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
 0.12 -0.14 -0.64 -0.63  0.49  0.21  0.36  0.80 -1.13 -0.25 -0.06 -0.20 -0.10 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.06  0.41 -1.80  0.02 -0.71 -0.90 -0.93  0.47 -1.66  0.22  0.90  0.08  0.57 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-1.31 -1.46 -0.75  0.70 -0.95 -0.84  0.01  0.75 -0.26  0.90  0.23 -1.14  0.85 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
 0.65 -0.10  0.11 -1.29 -0.77 -0.48 -1.43  1.18  1.08 -0.03  0.62 -0.33 -1.92 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.06 -0.01 -1.34 -0.08  0.75  1.06  0.03  0.34 -0.82  0.73  0.26 -0.19  0.38 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
 0.79  0.72 -1.20 -2.28  1.35 -0.42 -0.29  1.21 -0.34  0.85  1.18 -0.35  0.35 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
 0.48 -1.90 -0.86  0.40  1.22 -0.49 -0.08 -0.11  0.64  1.26 -1.02  0.29  1.39 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
 0.58 -1.18  0.31 -0.76  0.75 -0.32  0.92  0.59  0.40 -1.74  0.07 -0.56 -0.56 
  196   197   198   199   200 
 0.40  0.49  0.00 -1.00 -0.11 

> residuals( x )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-2.74 -1.61  0.72 -0.71 -0.58  0.48 -0.59 -1.42 -2.20 -0.33  0.30 -0.43 -1.28 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
-0.51 -1.45 -0.80 -0.62 -1.90 -1.09 -1.71 -1.27 -0.45 -1.89 -1.41 -0.78 -1.01 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
-0.30 -0.73 -1.41 -0.40 -1.61 -0.18  0.41 -0.55 -0.05 -1.06  0.05 -1.02 -0.85 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-1.08 -1.21 -0.70 -2.44  0.03  0.62 -2.85 -0.27 -1.72 -0.25 -0.50 -0.21 -0.55 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
-0.40  0.68 -1.65  0.91 -2.06 -0.29 -0.16 -1.50 -0.26 -0.76 -0.24 -2.07 -3.23 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-1.57 -0.14 -1.96  0.11  1.23 -1.18 -2.45 -0.06 -1.99 -1.24  0.20 -0.26 -0.72 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
-0.36 -0.37 -1.88 -0.51 -0.60  0.09 -0.17  0.14  0.41 -1.55 -0.35  0.50 -1.08 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
-0.79 -1.05 -1.54 -1.54 -0.41 -0.69 -0.55 -0.11 -2.04 -1.15 -0.97 -1.11 -1.00 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.96 -0.50 -2.71 -0.89 -1.61 -1.81 -1.84 -0.44 -2.57 -0.68 -0.01 -0.82 -0.34 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-2.22 -2.37 -1.66 -0.21 -1.86 -1.74 -0.89 -0.16 -1.17 -0.01 -0.68 -2.05 -0.06 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
-0.26 -1.00 -0.80 -2.20 -1.68 -1.39 -2.34  0.27  0.17 -0.93 -0.29 -1.23 -2.83 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.97 -0.92 -2.24 -0.98 -0.16  0.16 -0.88 -0.57 -1.73 -0.18 -0.65 -1.10 -0.53 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
-0.12 -0.19 -2.11 -3.18  0.45 -1.33 -1.20  0.30 -1.25 -0.06  0.27 -1.26 -0.56 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
-0.43 -2.81 -1.76 -0.50  0.31 -1.40 -0.99 -1.02 -0.27  0.36 -1.93 -0.62  0.48 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
-0.33 -2.08 -0.60 -1.67 -0.15 -1.22  0.01 -0.32 -0.50 -2.65 -0.84 -1.47 -1.47 
  196   197   198   199   200 
-0.51 -0.42 -0.91 -1.91 -1.02 

> fitted( x, which = "first" )
  [1] 0.48 0.12 0.19 1.04 1.14 1.39 0.12 0.12 0.23 0.11 1.32 1.45 1.01 0.11 0.12
 [16] 0.12 2.17 0.39 0.98 0.13 0.12 0.88 0.10 1.57 0.11 0.18 0.10 0.10 0.94 0.10
 [31] 0.93 0.24 0.33 1.38 0.30 0.12 1.46 2.32 2.29 0.13 0.27 0.10 0.12 0.11 0.49
 [46] 0.10 0.19 0.38 0.13 0.41 0.16 0.34 0.11 0.82 0.92 0.22 0.42 0.56 0.96 0.35
 [61] 0.24 0.45 0.70 0.12 0.68 0.71 1.25 0.11 0.10 0.20 0.17 0.13 0.31 0.12 1.20
 [76] 0.19 0.34 0.24 0.11 1.39 0.11 0.21 0.15 0.11 0.49 0.22 0.74 0.14 0.24 0.10
 [91] 1.40 0.18 0.36 2.29 0.93 0.12 0.31 0.15 0.15 0.11 0.21 2.23 0.36 1.13 0.35
[106] 0.94 0.15 0.93 0.12 0.82 0.10 1.30 0.88 0.66 0.56 1.35 1.41 2.13 0.60 0.10
[121] 0.10 0.25 0.18 0.11 2.36 0.11 0.92 0.75 0.14 0.74 0.12 0.18 0.10 1.18 0.10
[136] 1.06 0.23 0.15 0.72 0.15 0.10 0.70 0.12 0.11 0.30 0.17 0.11 0.18 0.10 0.27
[151] 0.33 0.57 0.42 0.22 0.10 0.12 0.11 0.17 0.41 0.80 0.14 0.14 1.28 2.27 0.88
[166] 0.11 0.98 0.41 0.46 1.03 0.17 0.17 0.14 0.81 1.45 0.90 0.22 1.41 0.33 0.88
[181] 0.58 0.88 0.54 1.40 0.19 0.11 1.42 0.11 0.14 0.90 0.46 0.10 0.35 0.11 0.79
[196] 0.10 0.24 1.45 0.98 0.45

> fitted( x )
  [1] 1.38 1.02 1.09 1.95 2.05 2.29 1.03 1.02 1.14 1.01 2.23 2.35 1.92 1.02 1.02
 [16] 1.03 3.07 1.30 1.89 1.03 1.03 1.79 1.01 2.48 1.02 1.09 1.01 1.01 1.84 1.01
 [31] 1.84 1.15 1.24 2.29 1.21 1.03 2.37 3.23 3.20 1.04 1.18 1.01 1.03 1.02 1.40
 [46] 1.01 1.10 1.29 1.03 1.32 1.07 1.25 1.02 1.73 1.83 1.13 1.33 1.47 1.87 1.25
 [61] 1.15 1.35 1.61 1.03 1.59 1.62 2.16 1.01 1.01 1.11 1.08 1.04 1.22 1.03 2.11
 [76] 1.10 1.25 1.15 1.02 2.30 1.02 1.12 1.06 1.01 1.40 1.13 1.65 1.05 1.14 1.01
 [91] 2.31 1.09 1.27 3.20 1.83 1.03 1.22 1.06 1.06 1.01 1.12 3.13 1.26 2.04 1.26
[106] 1.85 1.06 1.83 1.03 1.73 1.01 2.21 1.79 1.57 1.47 2.26 2.32 3.04 1.51 1.01
[121] 1.01 1.16 1.08 1.02 3.26 1.01 1.82 1.66 1.05 1.65 1.03 1.08 1.01 2.08 1.01
[136] 1.96 1.14 1.05 1.63 1.05 1.01 1.61 1.03 1.02 1.21 1.08 1.02 1.09 1.01 1.17
[151] 1.24 1.48 1.32 1.13 1.01 1.03 1.02 1.08 1.32 1.70 1.04 1.04 2.19 3.18 1.79
[166] 1.01 1.89 1.32 1.36 1.93 1.07 1.08 1.04 1.72 2.36 1.80 1.13 2.32 1.23 1.79
[181] 1.49 1.79 1.44 2.31 1.10 1.02 2.33 1.02 1.05 1.81 1.37 1.01 1.26 1.02 1.69
[196] 1.01 1.15 2.36 1.88 1.36

gradients( x )
        [,1]
  [1,]  0.76
  [2,]  0.38
  [3,]  0.57
  [4,]  0.86
  [5,]  1.07
  [6,]  1.69
  [7,]  0.39
  [8,]  0.38
  [9,]  0.64
 [10,]  0.35
 [11,]  1.14
 [12,]  0.28
 [13,]  0.81
 [14,]  0.36
 [15,]  0.38
 [16,]  0.39
 [17,]  0.59
 [18,]  0.68
 [19,]  0.79
 [20,]  0.41
 [21,]  0.40
 [22,]  0.21
 [23,]  0.33
 [24,]  0.98
 [25,]  0.37
 [26,]  0.56
 [27,]  0.33
 [28,]  0.34
 [29,] -1.13
 [30,]  0.33
 [31,]  0.99
 [32,]  0.65
 [33,]  0.69
 [34,] -1.16
 [35,]  0.69
 [36,]  0.39
 [37,]  1.50
 [38,] -0.06
 [39,]  0.22
 [40,]  0.42
 [41,]  0.68
 [42,]  0.34
 [43,]  0.40
 [44,]  0.38
 [45,]  0.79
 [46,]  0.34
 [47,]  0.58
 [48,]  0.68
 [49,]  0.41
 [50,]  0.69
 [51,]  0.50
 [52,]  0.69
 [53,]  0.37
 [54,]  0.93
 [55,] -0.98
 [56,]  0.62
 [57,]  0.70
 [58,]  0.91
 [59,]  0.79
 [60,]  0.69
 [61,]  0.65
 [62,]  0.72
 [63,]  1.02
 [64,]  0.39
 [65,]  1.02
 [66,]  1.02
 [67,]  1.20
 [68,]  0.35
 [69,]  0.33
 [70,]  0.59
 [71,]  0.53
 [72,]  0.43
 [73,]  0.69
 [74,]  0.39
 [75,]  1.81
 [76,]  0.58
 [77,]  0.69
 [78,]  0.65
 [79,]  0.37
 [80,] -1.07
 [81,]  0.37
 [82,]  0.61
 [83,]  0.49
 [84,]  0.35
 [85,]  0.80
 [86,]  0.63
 [87,]  1.00
 [88,]  0.46
 [89,]  0.65
 [90,]  0.34
 [91,]  0.83
 [92,]  0.56
 [93,]  0.68
 [94,]  0.43
 [95,]  0.81
 [96,]  0.39
 [97,]  0.69
 [98,]  0.48
 [99,]  0.48
[100,]  0.35
[101,]  0.61
[102,]  0.22
[103,]  0.68
[104,] -0.24
[105,]  0.69
[106,]  0.80
[107,]  0.48
[108,]  0.94
[109,]  0.39
[110,]  0.93
[111,]  0.33
[112,]  1.80
[113,] -0.16
[114,]  1.01
[115,]  0.91
[116,] -1.37
[117,] -0.90
[118,]  0.13
[119,]  0.97
[120,]  0.34
[121,]  0.33
[122,]  0.66
[123,]  0.54
[124,]  0.37
[125,] -1.58
[126,]  0.35
[127,]  0.82
[128,]  1.00
[129,]  0.45
[130,]  1.01
[131,]  0.40
[132,]  0.54
[133,]  0.33
[134,]  1.13
[135,]  0.33
[136,]  1.58
[137,]  0.64
[138,]  0.47
[139,]  1.01
[140,]  0.47
[141,]  0.33
[142,]  1.02
[143,]  0.39
[144,]  0.36
[145,]  0.69
[146,]  0.52
[147,]  0.37
[148,]  0.55
[149,]  0.33
[150,]  0.67
[151,]  0.69
[152,]  0.93
[153,]  0.69
[154,]  0.63
[155,]  0.33
[156,]  0.39
[157,]  0.36
[158,]  0.54
[159,]  0.69
[160,]  0.96
[161,]  0.44
[162,]  0.45
[163,] -1.69
[164,]  0.54
[165,]  0.86
[166,]  0.35
[167,]  1.31
[168,]  0.69
[169,]  0.74
[170,]  0.83
[171,]  0.52
[172,]  0.54
[173,]  0.44
[174,]  0.94
[175,]  0.25
[176,] -0.63
[177,]  0.63
[178,] -0.83
[179,]  0.69
[180,]  0.32
[181,]  0.95
[182,]  0.86
[183,]  0.87
[184,]  0.80
[185,]  0.58
[186,]  0.38
[187,] -0.73
[188,]  0.38
[189,]  0.45
[190,]  0.62
[191,]  0.74
[192,]  0.34
[193,]  0.69
[194,]  0.37
[195,]  0.97
[196,]  0.33
[197,]  0.65
[198,]  0.00
[199,]  0.79
[200,]  0.72
> 
> # local-linear regression, aic bandwidths
> sfa.flw.ll.aic <- sfaFLW( y ~ x, bwmethod = "cv.aic",
+   npArg = list( regtype = "ll" ) )
Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 |Multistart 1 of 1 /Multistart 1 of 1 |Multistart 1 of 1 |                   > 
> printFLW( sfa.flw.ll.aic )
$npreg

Regression Data: 200 training points, in 1 variable(s)
                 x
Bandwidth(s): 1.89

Kernel Regression Estimator: Local-Linear
Bandwidth Type: Fixed

Continuous Kernel Type: Second-Order Gaussian
No. Continuous Explanatory Vars.: 1


$mu
[1] 0.93

$mprime
       [,1]
  [1,] 0.58
  [2,] 0.61
  [3,] 0.61
  [4,] 0.55
  [5,] 0.55
  [6,] 0.49
  [7,] 0.61
  [8,] 0.61
  [9,] 0.60
 [10,] 0.61
 [11,] 0.54
 [12,] 0.53
 [13,] 0.55
 [14,] 0.61
 [15,] 0.61
 [16,] 0.61
 [17,] 0.42
 [18,] 0.59
 [19,] 0.56
 [20,] 0.61
 [21,] 0.61
 [22,] 0.51
 [23,] 0.62
 [24,] 0.48
 [25,] 0.61
 [26,] 0.61
 [27,] 0.62
 [28,] 0.62
 [29,] 0.51
 [30,] 0.62
 [31,] 0.50
 [32,] 0.60
 [33,] 0.59
 [34,] 0.52
 [35,] 0.60
 [36,] 0.61
 [37,] 0.49
 [38,] 0.39
 [39,] 0.30
 [40,] 0.61
 [41,] 0.60
 [42,] 0.62
 [43,] 0.61
 [44,] 0.61
 [45,] 0.58
 [46,] 0.62
 [47,] 0.61
 [48,] 0.59
 [49,] 0.61
 [50,] 0.59
 [51,] 0.61
 [52,] 0.59
 [53,] 0.61
 [54,] 0.57
 [55,] 0.51
 [56,] 0.60
 [57,] 0.59
 [58,] 0.58
 [59,] 0.56
 [60,] 0.59
 [61,] 0.60
 [62,] 0.59
 [63,] 0.57
 [64,] 0.61
 [65,] 0.57
 [66,] 0.57
 [67,] 0.54
 [68,] 0.61
 [69,] 0.62
 [70,] 0.60
 [71,] 0.61
 [72,] 0.61
 [73,] 0.60
 [74,] 0.61
 [75,] 0.49
 [76,] 0.61
 [77,] 0.59
 [78,] 0.60
 [79,] 0.61
 [80,] 0.53
 [81,] 0.61
 [82,] 0.60
 [83,] 0.61
 [84,] 0.62
 [85,] 0.58
 [86,] 0.60
 [87,] 0.57
 [88,] 0.61
 [89,] 0.60
 [90,] 0.62
 [91,] 0.54
 [92,] 0.61
 [93,] 0.59
 [94,] 0.40
 [95,] 0.56
 [96,] 0.61
 [97,] 0.60
 [98,] 0.61
 [99,] 0.61
[100,] 0.62
[101,] 0.60
[102,] 0.33
[103,] 0.59
[104,] 0.46
[105,] 0.59
[106,] 0.56
[107,] 0.61
[108,] 0.50
[109,] 0.61
[110,] 0.57
[111,] 0.62
[112,] 0.49
[113,] 0.51
[114,] 0.57
[115,] 0.58
[116,] 0.52
[117,] 0.53
[118,] 0.42
[119,] 0.58
[120,] 0.62
[121,] 0.62
[122,] 0.60
[123,] 0.61
[124,] 0.61
[125,] 0.43
[126,] 0.61
[127,] 0.56
[128,] 0.57
[129,] 0.61
[130,] 0.57
[131,] 0.61
[132,] 0.61
[133,] 0.62
[134,] 0.55
[135,] 0.62
[136,] 0.50
[137,] 0.60
[138,] 0.61
[139,] 0.57
[140,] 0.61
[141,] 0.62
[142,] 0.57
[143,] 0.61
[144,] 0.61
[145,] 0.60
[146,] 0.61
[147,] 0.61
[148,] 0.61
[149,] 0.62
[150,] 0.60
[151,] 0.59
[152,] 0.58
[153,] 0.59
[154,] 0.60
[155,] 0.62
[156,] 0.61
[157,] 0.61
[158,] 0.61
[159,] 0.59
[160,] 0.57
[161,] 0.61
[162,] 0.61
[163,] 0.52
[164,] 0.41
[165,] 0.56
[166,] 0.61
[167,] 0.50
[168,] 0.59
[169,] 0.59
[170,] 0.55
[171,] 0.61
[172,] 0.61
[173,] 0.61
[174,] 0.57
[175,] 0.53
[176,] 0.51
[177,] 0.60
[178,] 0.53
[179,] 0.60
[180,] 0.51
[181,] 0.58
[182,] 0.56
[183,] 0.58
[184,] 0.54
[185,] 0.61
[186,] 0.61
[187,] 0.53
[188,] 0.61
[189,] 0.61
[190,] 0.50
[191,] 0.59
[192,] 0.62
[193,] 0.59
[194,] 0.61
[195,] 0.57
[196,] 0.62
[197,] 0.60
[198,] 0.00
[199,] 0.56
[200,] 0.59

$sigma.sq
[1] 1.64

$lambda
[1] 2.13

$sigma.u
[1] 1.16

$sigma.v
[1] 0.54

$bw
[1] 1.89

> residuals( x, which = "first" )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-1.84 -0.72  1.59  0.40  0.58  1.31  0.30 -0.53 -1.33  0.57  1.56  0.88 -0.18 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
 0.39 -0.56  0.09  0.40 -1.02  0.00 -0.83 -0.38  0.03 -0.99 -0.45  0.12 -0.14 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
 0.60  0.18 -0.81  0.50 -1.11  0.69  1.28  0.61  0.82 -0.17  0.94  0.06  0.04 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-0.20 -0.34  0.20 -1.55  0.93  1.53 -1.95  0.59 -0.84  0.63  0.39  0.66  0.33 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
 0.49  1.72 -1.07  1.78 -1.17  0.64  0.93 -0.63  0.60  0.14  0.74 -1.18 -2.26 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-0.58  1.08 -1.06  1.01  2.09 -0.31 -1.57  0.81 -1.10 -0.55  1.07  0.62  0.14 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
 0.53  0.81 -0.98  0.35  0.27  0.99  0.73  1.01  1.41 -0.67  0.52  1.40  0.22 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
 0.08 -0.17 -0.45 -0.47  0.48  0.18  0.32  0.77 -1.14 -0.29 -0.14 -0.23 -0.68 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-0.08  0.58 -1.83 -0.39 -0.72 -0.77 -0.93  0.33 -2.07  0.28  0.92  0.30  0.87 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-1.21 -1.43 -0.76  0.70 -0.99 -0.87  0.00  1.16 -0.27  1.06  0.33 -1.17  0.95 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
 0.63 -0.13  0.10 -1.02 -0.77 -0.81 -1.47  1.15  1.17 -0.06  0.61 -0.25 -1.94 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-0.07 -0.05 -1.37 -0.09  0.71  1.06 -0.01  0.31 -0.80  0.71  0.22 -0.19  0.36 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
 0.78  0.68 -1.22 -2.15  1.33 -0.45 -0.16  1.38 -0.19  0.84  0.81 -0.37  0.34 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
 0.68 -1.94 -0.89  0.38  1.35 -0.09 -0.46 -0.15  0.95  1.23 -1.45  0.32  1.54 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
 0.59 -0.78  0.27 -0.78  1.08 -0.33  0.89  0.17  0.39 -1.75  0.04 -0.58 -0.45 
  196   197   198   199   200 
 0.39  0.45 -0.45 -0.82 -0.12 

> residuals( x )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
-2.77 -1.65  0.67 -0.52 -0.35  0.39 -0.63 -1.46 -2.25 -0.36  0.63 -0.05 -1.10 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
-0.54 -1.48 -0.84 -0.52 -1.95 -0.92 -1.75 -1.31 -0.89 -1.91 -1.37 -0.81 -1.07 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
-0.32 -0.75 -1.74 -0.43 -2.04 -0.24  0.36 -0.32 -0.10 -1.09  0.01 -0.87 -0.89 
   40    41    42    43    44    45    46    47    48    49    50    51    52 
-1.13 -1.27 -0.72 -2.48  0.00  0.60 -2.87 -0.33 -1.76 -0.29 -0.53 -0.26 -0.60 
   53    54    55    56    57    58    59    60    61    62    63    64    65 
-0.44  0.79 -2.00  0.85 -2.10 -0.29  0.01 -1.55 -0.32 -0.79 -0.18 -2.11 -3.18 
   66    67    68    69    70    71    72    73    74    75    76    77    78 
-1.50  0.15 -1.99  0.09  1.17 -1.24 -2.50 -0.11 -2.03 -1.48  0.14 -0.31 -0.78 
   79    80    81    82    83    84    85    86    87    88    89    90    91 
-0.39 -0.12 -1.91 -0.57 -0.65  0.06 -0.19  0.08  0.49 -1.60 -0.41  0.48 -0.71 
   92    93    94    95    96    97    98    99   100   101   102   103   104 
-0.84 -1.09 -1.38 -1.39 -0.45 -0.74 -0.60 -0.16 -2.07 -1.21 -1.06 -1.15 -1.61 
  105   106   107   108   109   110   111   112   113   114   115   116   117 
-1.01 -0.34 -2.76 -1.32 -1.65 -1.69 -1.86 -0.60 -3.00 -0.64 -0.01 -0.63 -0.06 
  118   119   120   121   122   123   124   125   126   127   128   129   130 
-2.13 -2.35 -1.68 -0.23 -1.92 -1.80 -0.92  0.24 -1.20  0.14 -0.60 -2.10  0.02 
  131   132   133   134   135   136   137   138   139   140   141   142   143 
-0.29 -1.06 -0.82 -1.94 -1.70 -1.73 -2.40  0.22  0.24 -0.98 -0.31 -1.18 -2.86 
  144   145   146   147   148   149   150   151   152   153   154   155   156 
-1.00 -0.97 -2.30 -1.02 -0.21  0.13 -0.94 -0.62 -1.73 -0.22 -0.71 -1.12 -0.56 
  157   158   159   160   161   162   163   164   165   166   167   168   169 
-0.15 -0.24 -2.14 -3.08  0.40 -1.38 -1.09  0.46 -1.12 -0.08 -0.12 -1.30 -0.59 
  170   171   172   173   174   175   176   177   178   179   180   181   182 
-0.25 -2.86 -1.82 -0.55  0.42 -1.02 -1.38 -1.07  0.02  0.31 -2.37 -0.61  0.61 
  183   184   185   186   187   188   189   190   191   192   193   194   195 
-0.34 -1.70 -0.66 -1.70  0.15 -1.26 -0.04 -0.76 -0.53 -2.68 -0.89 -1.50 -1.37 
  196   197   198   199   200 
-0.53 -0.48 -1.37 -1.74 -1.05 

> fitted( x, which = "first" )
  [1] 0.48 0.13 0.23 0.83 0.89 1.46 0.14 0.13 0.27 0.11 0.97 1.04 0.81 0.12 0.13
 [16] 0.13 2.05 0.42 0.79 0.15 0.14 1.30 0.10 1.52 0.12 0.22 0.10 0.11 1.25 0.10
 [31] 1.34 0.28 0.36 1.12 0.34 0.14 1.48 2.15 2.32 0.15 0.31 0.11 0.14 0.13 0.50
 [46] 0.11 0.23 0.41 0.15 0.43 0.19 0.37 0.13 0.69 1.26 0.26 0.44 0.54 0.78 0.37
 [61] 0.28 0.46 0.62 0.13 0.61 0.63 0.94 0.11 0.10 0.24 0.21 0.16 0.34 0.14 1.42
 [76] 0.23 0.37 0.28 0.13 1.12 0.13 0.25 0.19 0.11 0.50 0.26 0.65 0.17 0.28 0.11
 [91] 1.00 0.22 0.39 2.11 0.76 0.14 0.35 0.18 0.18 0.11 0.25 2.30 0.38 1.72 0.38
[106] 0.77 0.18 1.34 0.14 0.69 0.11 1.44 1.29 0.60 0.54 1.13 1.11 2.02 0.57 0.11
[121] 0.10 0.29 0.21 0.13 1.94 0.11 0.75 0.65 0.17 0.64 0.14 0.21 0.11 0.90 0.11
[136] 1.38 0.27 0.18 0.64 0.18 0.11 0.62 0.14 0.12 0.34 0.20 0.12 0.22 0.11 0.30
[151] 0.36 0.55 0.44 0.26 0.11 0.13 0.12 0.21 0.43 0.68 0.16 0.16 1.16 2.10 0.73
[166] 0.11 1.36 0.43 0.47 0.82 0.20 0.21 0.16 0.68 1.05 1.27 0.26 1.11 0.36 1.31
[181] 0.56 0.73 0.53 1.01 0.23 0.13 1.10 0.13 0.17 1.32 0.47 0.11 0.38 0.13 0.67
[196] 0.10 0.28 1.90 0.79 0.46

> fitted( x )
  [1] 1.41 1.06 1.15 1.76 1.81 2.39 1.06 1.06 1.20 1.04 1.89 1.97 1.74 1.05 1.06
 [16] 1.06 2.98 1.34 1.72 1.07 1.07 2.23 1.03 2.44 1.05 1.15 1.03 1.03 2.17 1.03
 [31] 2.27 1.20 1.29 2.05 1.26 1.06 2.41 3.08 3.24 1.08 1.24 1.04 1.07 1.05 1.42
 [46] 1.03 1.16 1.33 1.07 1.35 1.12 1.30 1.05 1.62 2.18 1.18 1.36 1.47 1.71 1.30
 [61] 1.21 1.39 1.55 1.06 1.54 1.56 1.86 1.04 1.03 1.17 1.14 1.08 1.27 1.06 2.34
 [76] 1.16 1.30 1.21 1.05 2.04 1.05 1.18 1.11 1.04 1.42 1.19 1.57 1.10 1.20 1.04
 [91] 1.93 1.15 1.32 3.03 1.68 1.06 1.27 1.11 1.11 1.04 1.18 3.23 1.31 2.65 1.30
[106] 1.69 1.11 2.26 1.06 1.62 1.03 2.37 2.21 1.53 1.47 2.06 2.04 2.95 1.49 1.03
[121] 1.03 1.22 1.14 1.05 2.87 1.04 1.68 1.58 1.09 1.57 1.07 1.14 1.03 1.83 1.03
[136] 2.31 1.20 1.10 1.56 1.10 1.03 1.55 1.06 1.05 1.26 1.13 1.05 1.15 1.03 1.23
[151] 1.29 1.48 1.36 1.19 1.03 1.06 1.05 1.14 1.36 1.60 1.09 1.09 2.08 3.02 1.65
[166] 1.04 2.28 1.36 1.40 1.75 1.13 1.14 1.09 1.61 1.97 2.20 1.19 2.03 1.28 2.23
[181] 1.48 1.65 1.45 1.93 1.16 1.05 2.03 1.06 1.09 2.25 1.40 1.04 1.30 1.05 1.60
[196] 1.03 1.20 2.82 1.72 1.39

gradients( x )
       [,1]
  [1,] 0.58
  [2,] 0.61
  [3,] 0.61
  [4,] 0.55
  [5,] 0.55
  [6,] 0.49
  [7,] 0.61
  [8,] 0.61
  [9,] 0.60
 [10,] 0.61
 [11,] 0.54
 [12,] 0.53
 [13,] 0.55
 [14,] 0.61
 [15,] 0.61
 [16,] 0.61
 [17,] 0.42
 [18,] 0.59
 [19,] 0.56
 [20,] 0.61
 [21,] 0.61
 [22,] 0.51
 [23,] 0.62
 [24,] 0.48
 [25,] 0.61
 [26,] 0.61
 [27,] 0.62
 [28,] 0.62
 [29,] 0.51
 [30,] 0.62
 [31,] 0.50
 [32,] 0.60
 [33,] 0.59
 [34,] 0.52
 [35,] 0.60
 [36,] 0.61
 [37,] 0.49
 [38,] 0.39
 [39,] 0.30
 [40,] 0.61
 [41,] 0.60
 [42,] 0.62
 [43,] 0.61
 [44,] 0.61
 [45,] 0.58
 [46,] 0.62
 [47,] 0.61
 [48,] 0.59
 [49,] 0.61
 [50,] 0.59
 [51,] 0.61
 [52,] 0.59
 [53,] 0.61
 [54,] 0.57
 [55,] 0.51
 [56,] 0.60
 [57,] 0.59
 [58,] 0.58
 [59,] 0.56
 [60,] 0.59
 [61,] 0.60
 [62,] 0.59
 [63,] 0.57
 [64,] 0.61
 [65,] 0.57
 [66,] 0.57
 [67,] 0.54
 [68,] 0.61
 [69,] 0.62
 [70,] 0.60
 [71,] 0.61
 [72,] 0.61
 [73,] 0.60
 [74,] 0.61
 [75,] 0.49
 [76,] 0.61
 [77,] 0.59
 [78,] 0.60
 [79,] 0.61
 [80,] 0.53
 [81,] 0.61
 [82,] 0.60
 [83,] 0.61
 [84,] 0.62
 [85,] 0.58
 [86,] 0.60
 [87,] 0.57
 [88,] 0.61
 [89,] 0.60
 [90,] 0.62
 [91,] 0.54
 [92,] 0.61
 [93,] 0.59
 [94,] 0.40
 [95,] 0.56
 [96,] 0.61
 [97,] 0.60
 [98,] 0.61
 [99,] 0.61
[100,] 0.62
[101,] 0.60
[102,] 0.33
[103,] 0.59
[104,] 0.46
[105,] 0.59
[106,] 0.56
[107,] 0.61
[108,] 0.50
[109,] 0.61
[110,] 0.57
[111,] 0.62
[112,] 0.49
[113,] 0.51
[114,] 0.57
[115,] 0.58
[116,] 0.52
[117,] 0.53
[118,] 0.42
[119,] 0.58
[120,] 0.62
[121,] 0.62
[122,] 0.60
[123,] 0.61
[124,] 0.61
[125,] 0.43
[126,] 0.61
[127,] 0.56
[128,] 0.57
[129,] 0.61
[130,] 0.57
[131,] 0.61
[132,] 0.61
[133,] 0.62
[134,] 0.55
[135,] 0.62
[136,] 0.50
[137,] 0.60
[138,] 0.61
[139,] 0.57
[140,] 0.61
[141,] 0.62
[142,] 0.57
[143,] 0.61
[144,] 0.61
[145,] 0.60
[146,] 0.61
[147,] 0.61
[148,] 0.61
[149,] 0.62
[150,] 0.60
[151,] 0.59
[152,] 0.58
[153,] 0.59
[154,] 0.60
[155,] 0.62
[156,] 0.61
[157,] 0.61
[158,] 0.61
[159,] 0.59
[160,] 0.57
[161,] 0.61
[162,] 0.61
[163,] 0.52
[164,] 0.41
[165,] 0.56
[166,] 0.61
[167,] 0.50
[168,] 0.59
[169,] 0.59
[170,] 0.55
[171,] 0.61
[172,] 0.61
[173,] 0.61
[174,] 0.57
[175,] 0.53
[176,] 0.51
[177,] 0.60
[178,] 0.53
[179,] 0.60
[180,] 0.51
[181,] 0.58
[182,] 0.56
[183,] 0.58
[184,] 0.54
[185,] 0.61
[186,] 0.61
[187,] 0.53
[188,] 0.61
[189,] 0.61
[190,] 0.50
[191,] 0.59
[192,] 0.62
[193,] 0.59
[194,] 0.61
[195,] 0.57
[196,] 0.62
[197,] 0.60
[198,] 0.00
[199,] 0.56
[200,] 0.59
> 
> # no intercept
> sfa.flw.ll2 <- sfaFLW( y ~ x - 1, bwmethod = "rot",
+   npArg = list( regtype = "ll" ) )
Warning message:
In sfaFLW(y ~ x - 1, bwmethod = "rot", npArg = list(regtype = "ll")) :
  the intercept cannot be suppressed in nonparametric regression
> 
> all.equal( sfa.flw.ll[ -1 ], sfa.flw.ll2[ -1 ] )
[1] TRUE
> all.equal( residuals( sfa.flw.ll, which = "first" ),
+   residuals( sfa.flw.ll, which = "first" ) )
[1] TRUE
> all.equal( residuals( sfa.flw.ll ), residuals( sfa.flw.ll ) )
[1] TRUE
> 
> all.equal( fitted( sfa.flw.ll, which = "first" ),
+   fitted( sfa.flw.ll, which = "first" ) )
[1] TRUE
> all.equal( fitted( sfa.flw.ll ), fitted( sfa.flw.ll ) )
[1] TRUE
> 
> all.equal( gradients( sfa.flw.ll ), gradients( sfa.flw.ll ) )
[1] TRUE
> 
> # wrong value of argument 'bwmethod'
> try( sfaFLW( y ~ x, bwmethod = "unknown" ) )
Error in sfaFLW(y ~ x, bwmethod = "unknown") : 
  argument 'bwmethod' must be either 'cv.ls', 'cv.aic', or 'rot'
> 
> # wrong values of argument 'npArg'
> try( sfaFLW( y ~ x, npArg = c( regtype = "ll" ) ) )
Error in sfaFLW(y ~ x, npArg = c(regtype = "ll")) : 
  argument 'npArg' must be a list
> try( sfaFLW( y ~ x, npArg = list( bwmethod = "cv.aic." ) ) )
Error in sfaFLW(y ~ x, npArg = list(bwmethod = "cv.aic.")) : 
  argument 'npArg' may not be used to specify arguments 'xdat', 'ydat', 'bwmethod', and 'bandwidth.compute'
> try( sfaFLW( y ~ x, npArg = list( regtype = "something" ) ) )
Error in match.arg(regtype) : 'arg' should be one of "lc", "ll"
> 
> # residuals: wrong value of argument 'which'
> try( residuals( sfa.flw, which = "failed" ) )
Error in residuals.sfaFLW(sfa.flw, which = "failed") : 
  argument 'which' must be either "first" or "final"
> 
> # fitted: wrong value of argument 'which'
> try( fitted( sfa.flw, which = "not allowed" ) )
Error in fitted.sfaFLW(sfa.flw, which = "not allowed") : 
  argument 'which' must be either "first" or "frontier"
> 
> proc.time()
   user  system elapsed 
  1.400   0.044   1.440 
